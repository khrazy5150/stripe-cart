<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best NAD Supplement in 2025 | Anti-Aging & Energy Boost</title>
    <meta name="description" content="Premium NAD+ Nicotinamide Riboside with Resveratrol. Support cellular rejuvenation, boost energy, and enhance cognitive function. Limited time up to 50% off. Lab tested and verified.">
    <link rel="icon" type="image/x-icon" href="https://images.juniorbay.com/icon/favicon.png">
    <style>
/* CSS Variables (Design System) */
:root {
    --background: hsl(0, 0%, 100%);
    --foreground: hsl(0, 0, 0);
    --card: hsl(0, 0%, 100%);
    --card-foreground: hsl(150, 60%, 15%);
    --cool: hsl(217, 91%, 60%);
    --primary: hsl(150, 70%, 25%);
    --primary-foreground: hsl(0, 0%, 100%);
    --secondary: hsl(150, 15%, 95%);
    --secondary-foreground: hsl(150, 60%, 15%);
    --muted: hsl(150, 15%, 96%);
    --muted-foreground: hsl(215.4 16.3% 46.9%);
    --accent: hsl(43, 95%, 55%);
    --accent-foreground: hsl(150, 60%, 15%);
    --destructive: hsl(0, 85%, 55%);
    --destructive-foreground: hsl(0, 0%, 100%);
    --border: hsl(150, 20%, 90%);
    --radius: 0.75rem;
    
    --gradient-hero: linear-gradient(135deg, hsl(150, 70%, 25%) 0%, hsl(150, 65%, 35%) 100%);
    --gradient-card: linear-gradient(180deg, hsl(0, 0%, 100%) 0%, hsl(150, 15%, 98%) 100%);
    --gradient-urgent: linear-gradient(90deg, hsl(0, 85%, 50%) 0%, hsl(10, 85%, 55%) 100%);
    --shadow-card: 0 4px 20px -2px hsl(150, 70%, 25%, 0.1);
    --shadow-hover: 0 8px 30px -4px hsl(150, 70%, 25%, 0.2);
    --shadow-urgent: 0 4px 15px -2px hsl(0, 85%, 50%, 0.3);
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background-color: var(--background);
    color: var(--foreground);
    line-height: 1.5;
    min-height: 100vh;
}

/* Container */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1rem;
}

/* Loading State */
.loading-spinner {
    display: inline-block;
    width: 40px;
    height: 40px;
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-top-color: var(--cool);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 2rem auto;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.loading-state {
    text-align: center;
    padding: 3rem 1rem;
}

.error-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--destructive);
}

/* Countdown Banner */
.countdown-banner {
    background: var(--gradient-urgent);
    color: var(--destructive-foreground);
    padding: 0.75rem 1rem;
    box-shadow: var(--shadow-urgent);
}

.banner-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-align: center;
}

.banner-text {
    font-size: 0.875rem;
    font-weight: 700;
}

.countdown-timer {
    display: inline-block;
    min-width: 4rem;
    font-family: 'Courier New', monospace;
    font-size: 1.125rem;
    color: #ffef03;
}

.countdown-timer.expired {
    color: #ff6b6b;
}

@keyframes pulse-glow {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.02);
    }
}

/* Hero Section */
.hero-section {
    padding: 3rem 1rem;
}

.hero-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 3rem;
    align-items: center;
}

.hero-content {
    text-align: center;
}

.hero-title {
    font-size: 2.5rem;
    font-weight: 700;
    line-height: 1.2;
    margin-bottom: 1.5rem;
    color: var(--foreground);
}

.hero-gradient-text {
    background: var(--gradient-urgent);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
}

.hero-description {
    font-size: 1.125rem;
    color: var(--muted-foreground);
    margin-bottom: 1.5rem;
}

.hero-badges {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    justify-content: center;
}

.badge {
    background-color: var(--cool);
    padding: 0.5rem 1rem;
    border-radius: 9999px;
}

.badge p {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--card);
}

.hero-image-container {
    display: flex;
    justify-content: center;
}

.hero-image {
    width: 100%;
    max-width: 28rem;
    filter: drop-shadow(0 25px 25px rgba(0, 0, 0, 0.15));
    animation: slide-up 0.5s ease-out;
}

@keyframes slide-up {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Pricing Section */
.pricing-section {
    padding: 3rem 1rem;
    background: linear-gradient(180deg, var(--background) 0%, hsla(150, 15%, 95%, 0.2) 100%);
}

.section-header {
    text-align: center;
    margin-bottom: 3rem;
}

.section-title {
    font-size: 2rem;
    font-weight: 700;
    color: var(--foreground);
    margin-bottom: 1rem;
}

.section-description {
    font-size: 1.125rem;
    color: var(--muted-foreground);
}

.select-item {
    background-color: #f1f5f9;
    padding: 4rem 2rem;
    border-radius: 1rem;
}

.straight-container {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 1rem;
}

.box {
    margin: 0;
    padding: 0;
}

.package-card {
    padding: 2rem;
    border: 2px solid #e2e8f0;
    border-radius: 1rem;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    background-color: white;
}

.package-card:hover {
    border-color: var(--primary);
    background-color: hsla(150, 62%, 55%, 0.05);
    transform: translateY(-2px);
}

.package-card.selected {
    border-color: #3b84f6;
    background-color: rgba(59, 132, 246, 0.05);
}

.package-badge {
    position: absolute;
    top: -1rem;
    right: -1rem;
    background-color: var(--accent);
    color: var(--foreground);
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    font-weight: 600;
    font-size: 0.875rem;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.left {
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.right {
    text-align: right;
}

.right div {
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-end;
    align-items: baseline;
    gap: 0.5rem;
    row-gap: 0.25rem;
}

.right div p {
    width: 100%;
    text-align: right;
    margin: 0;
}

.icon-check {
    flex-shrink: 0;
}

.icon-pop {
    width: 1rem;
    height: 1rem;
    fill: currentColor;
}

.h-3 {
    height: 24px;
    width: 24px;
}

.icon-star {
    height: 24px;
    width: 24px;
}

.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 1.5rem 3rem;
    border-radius: var(--radius);
    font-weight: 600;
    transition: all 0.2s;
    border: none;
    cursor: pointer;
    text-decoration: none;
    font-size: 1.125rem;
}

.btn-primary {
    background-color: #3b84f6;
    color: white;
}

.btn-primary:hover {
    background-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: 0 10px 30px -10px hsla(150, 62%, 55%, 0.5);
}

/* Utility Classes */
.text-xs { font-size: 0.75rem; }
.text-sm { font-size: 0.875rem; }
.text-lg { font-size: 1.125rem; }
.text-2xl { font-size: 1.5rem; }

.text-blue { color: #3b84f6; }
.text-green { color: var(--primary); }

.muted { color: var(--muted-foreground); }
.strike { text-decoration: line-through; }
.semi-bold { font-weight: 600; }

.center { text-align: center; }
.mb-8 { margin-bottom: 2rem; }

.txt-reg { opacity: 1; }
.txt-discount { font-weight: 500; }
.txt-price { display: block; margin: 0; }
.txt-save { font-weight: 500; }

.checkout-info {
    text-align: center;
    padding: 2rem 0;
}

.checkout-info p {
    font-size: 0.875rem;
    color: var(--muted-foreground);
}

/* Benefits Section */
.benefits-section {
    padding: 4rem 1rem;
    background-color: hsla(150, 15%, 95%, 0.3);
}

.benefits-section .section-title {
    text-align: center;
    margin-bottom: 3rem;
}

.benefits-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
}

.benefit-item {
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    animation: slide-up 0.5s ease-out;
}

.benefit-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 4rem;
    height: 4rem;
    margin: 0 auto;
    border-radius: 50%;
    background-color: hsla(150, 70%, 25%, 0.1);
    color: var(--primary);
}

.benefit-icon svg {
    width: 2rem;
    height: 2rem;
}

.benefit-title {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--foreground);
}

.benefit-description {
    color: var(--muted-foreground);
}

/* Trust Section */
.trust-section {
    padding: 3rem 1rem;
    background-color: #e7f1f8;
}

.trust-container {
    max-width: 56rem;
    text-align: center;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.trust-description {
    color: var(--muted-foreground);
    max-width: 42rem;
    margin: 0 auto;
}

.stats-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 2rem;
    padding-top: 2rem;
}

.stat-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.stat-number {
    font-size: 2.25rem;
    font-weight: 700;
    color: #3b84f6;
}

.stat-label {
    color: #77a8f7;
}

footer {
    padding: 20px 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: #0b5294;
    color: #ffffff;
}

.footer-links {
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.link, 
.footer-links a {
    color: #ff8309;
    text-decoration: none;
}

.footer-links a:hover {
    color: #ffffff;
    text-decoration: underline;
}

/* Responsive Design */
@media (max-width: 640px) {
    .banner-text {
        font-size: 0.7rem;
    }
    
    .countdown-timer {
        font-size: 0.9rem;
        min-width: 3rem;
    }
    
    .hero-section {
        padding: 2rem 1rem;
    }
    
    .hero-title {
        font-size: 1.75rem;
    }
    
    .hero-description {
        font-size: 1rem;
    }
    
    .hero-badges {
        gap: 0.5rem;
    }
    
    .badge {
        padding: 0.4rem 0.75rem;
    }
    
    .badge p {
        font-size: 0.75rem;
    }
    
    .select-item {
        padding: 2rem 1rem;
    }
    
    .straight-container {
        padding: 0 0.5rem;
    }
    
    .package-card {
        flex-direction: column;
        align-items: stretch;
        gap: 1.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    
    .left {
        gap: 1rem;
        flex-direction: column;
    }
    
    .left h4 {
        font-size: 0.95rem;
        text-align: center;
    }

    .txt-discount {
        background-color: hsla(43, 95%, 55%, 0.2);
        color: var(--accent-foreground);
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-size: 0.875rem;
        font-weight: 600;
        text-align: center;
        margin-top: 2rem;
    }

    .right div {
        justify-content: center;
    }

    .right div p {
        text-align: center;
    }
    
    .txt-price {
        font-size: 1.75rem !important;
    }
    
    .package-badge {
        top: -0.75rem;
        right: -0.5rem;
        padding: 0.4rem 0.75rem;
        font-size: 0.75rem;
    }
    
    .icon-pop {
        width: 0.875rem;
        height: 0.875rem;
    }
    
    .btn {
        width: 100%;
        padding: 1.25rem 2rem;
        font-size: 1rem;
    }
    
    .section-title {
        font-size: 1.5rem;
    }
    
    .section-description {
        font-size: 1rem;
    }
    
    .benefits-section {
        padding: 2.5rem 1rem;
    }
    
    .benefit-icon {
        width: 3rem;
        height: 3rem;
    }
    
    .benefit-icon svg {
        width: 1.5rem;
        height: 1.5rem;
    }
    
    .benefit-title {
        font-size: 1.1rem;
    }
    
    .benefit-description {
        font-size: 0.9rem;
    }
    
    .trust-section {
        padding: 2.5rem 1rem;
    }
    
    .trust-description {
        font-size: 0.95rem;
    }
    
    .stat-number {
        font-size: 1.75rem;
    }
    
    .stat-label {
        font-size: 0.875rem;
    }
    
    .checkout-info p {
        font-size: 0.75rem;
    }
}

@media (min-width: 641px) and (max-width: 767px) {
    .hero-title {
        font-size: 2rem;
    }
    
    .package-card {
        flex-direction: column;
        align-items: stretch;
        gap: 1.5rem;
    }
}

@media (min-width: 768px) {
    .hero-section {
        padding: 5rem 1rem;
    }
    
    .hero-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 3rem;
    }
    
    .hero-content {
        text-align: left;
    }
    
    .hero-title {
        font-size: 3rem;
    }
    
    .hero-description {
        font-size: 1.25rem;
    }
    
    .hero-badges {
        justify-content: flex-start;
    }
    
    .section-title {
        font-size: 2.25rem;
    }
    
    .benefits-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .stats-grid {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .package-card {
        flex-direction: row;
        align-items: center;
    }
    
    .right {
        text-align: right;
    }
}

@media (min-width: 1024px) {
    .hero-title {
        font-size: 3.75rem;
    }
    
    .benefits-grid {
        grid-template-columns: repeat(4, 1fr);
    }
    
    .select-item {
        padding: 4rem 2rem;
    }
}
    </style>
</head>
<body>
    <!-- Loading State -->
    <div id="loadingState" class="loading-state">
        <div class="loading-spinner"></div>
        <p style="margin-top: 1rem; color: var(--muted-foreground);">Loading pricing...</p>
    </div>

    <!-- Error State -->
    <div id="errorState" class="error-state" style="display: none;">
        <h2>Unable to Load Products</h2>
        <p>Please refresh the page or contact support if the problem persists.</p>
    </div>

    <!-- Main Content -->
    <div id="mainContent" style="display: none;">
        <!-- Countdown Banner -->
        <div class="countdown-banner">
            <div class="container banner-content">
                <p class="banner-text">
                    ðŸ”¥ <span id="bannerText">Up to 50% off applied. Discount expires in:</span>
                    <span class="countdown-timer" id="countdown">05:00</span>
                </p>
            </div>
        </div>

        <!-- Hero Section -->
        <section class="hero-section">
            <div class="container">
                <div class="hero-grid">
                    <div class="hero-content">
                        <h1 class="hero-title">
                            Turn Back Time at the 
                            <span class="hero-gradient-text">Cellular Level</span>
                        </h1>
                        <p class="hero-description">
                            Feel younger, think sharper, live better. Experience the science-backed supplement that's helping thousands reclaim their vitality.
                        </p>
                        <div class="hero-badges">
                            <div class="badge">
                                <p>âœ“ Lab Tested</p>
                            </div>
                            <div class="badge">
                                <p>âœ“ 900mg NAD+</p>
                            </div>
                            <div class="badge">
                                <p>âœ“ + Resveratrol</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="hero-image-container">
                        <img src="https://images.juniorbay.com/products/0FO4bvZYZLU/medium.webp" alt="NAD+ Supplement" class="hero-image">
                    </div>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section class="pricing-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Choose Your Path to Vitality</h2>
                    <p class="section-description">
                        Bigger savings with larger quantities. All orders include free shipping.
                    </p>
                </div>

                <section class="select-item">
                    <div class="straight-container mx-auto">
                        <div class="text-center mb-8">
                            <h3 class="center">Choose Your Package</h3>
                        </div>
                        
                        <div class="box" id="packagesContainer">
                            <!-- Packages will be dynamically inserted here -->
                        </div>

                        <div class="center">
                            <button id="purchase-btn" class="btn btn-primary text-lg">
                                Order Now
                            </button>
                        </div>
                    </div>
                </section>

                <div class="checkout-info">
                    <p>ðŸ”’ Secure checkout â€¢ ðŸ’³ All major cards accepted â€¢ ðŸ“¦ Ships within 24 hours</p>
                </div>
            </div>
        </section>

        <!-- Benefits Section -->
        <section class="benefits-section">
            <div class="container">
                <h2 class="section-title">Why NAD+ Is Essential For Longevity</h2>
                <div class="benefits-grid">
                    <div class="benefit-item">
                        <div class="benefit-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                                <path d="M5 3v4"/>
                                <path d="M19 17v4"/>
                                <path d="M3 5h4"/>
                                <path d="M17 19h4"/>
                            </svg>
                        </div>
                        <h3 class="benefit-title">Cellular Rejuvenation</h3>
                        <p class="benefit-description">Supports DNA repair and cellular health for youthful vitality</p>
                    </div>

                    <div class="benefit-item" style="animation-delay: 100ms">
                        <div class="benefit-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect width="16" height="10" x="2" y="7" rx="2" ry="2"/>
                                <line x1="22" x2="22" y1="11" y2="13"/>
                                <line x1="6" x2="6" y1="11" y2="13"/>
                            </svg>
                        </div>
                        <h3 class="benefit-title">Enhanced Energy</h3>
                        <p class="benefit-description">Boosts cellular energy production for sustained vitality</p>
                    </div>

                    <div class="benefit-item" style="animation-delay: 200ms">
                        <div class="benefit-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/>
                            </svg>
                        </div>
                        <h3 class="benefit-title">Cognitive Support</h3>
                        <p class="benefit-description">Promotes brain health and mental clarity</p>
                    </div>

                    <div class="benefit-item" style="animation-delay: 300ms">
                        <div class="benefit-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
                                <path d="M3 6h18"/>
                                <path d="M16 10a4 4 0 0 1-8 0"/>
                            </svg>
                        </div>
                        <h3 class="benefit-title">Metabolic Health</h3>
                        <p class="benefit-description">Supports healthy metabolism and overall wellness</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Trust Section -->
        <section class="trust-section">
            <div class="container trust-container">
                <h2 class="section-title">Backed by Science, Trusted by Thousands</h2>
                <p class="trust-description">
                    NAD+ (Nicotinamide Adenine Dinucleotide) is a critical coenzyme found in every cell of your body. 
                    As we age, NAD+ levels naturally decline, affecting energy production, DNA repair, and cellular health. 
                    Our premium liposomal formula ensures maximum absorption and bioavailability.
                </p>
                <div class="stats-grid">
                    <div class="stat-item">
                        <p class="stat-number">15,000+</p>
                        <p class="stat-label">Happy Customers</p>
                    </div>
                    <div class="stat-item">
                        <p class="stat-number">4.8â˜…</p>
                        <p class="stat-label">Average Rating</p>
                    </div>
                    <div class="stat-item">
                        <p class="stat-number">30 Days</p>
                        <p class="stat-label">Money-Back Guarantee</p>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <div id="copyright" class="text-md">&copy; <span id="year"></span> Junior Bay Corporation</div>
            <div class="footer-links text-sm">
                <a href="contact/">Contact</a> | <a href="terms/">Terms</a> | <a href="privacy/">Privacy</a>
            </div>
        </footer>
    </div>

    <script>
// Configuration - Update these with your actual Stripe product IDs and discount percentages
const PRODUCT_CONFIG = [
    {
        stripeProductId: 'prod_1', // Replace with actual Stripe product ID
        name: 'Buy 1 NAD Supplement Pouch',
        defaultPrice: 3300,
        regularPriceOverride: 4800, // Optional: override if not from Stripe (in cents)
        tier: 'basic',
        isFeatured: false
    },
    {
        stripeProductId: 'prod_2',
        name: 'Buy 2 NAD Supplement Pouches',
        defaultPrice: 5900,
        regularPriceOverride: 9600,
        tier: 'medium',
        isFeatured: false
    },
    {
        stripeProductId: 'prod_3',
        name: 'Buy 3 NAD Supplement Pouches',
        defaultPrice: 8300,
        regularPriceOverride: 14400,
        tier: 'popular',
        isFeatured: true,
        badge: 'Most Popular'
    },
    {
        stripeProductId: 'prod_6',
        name: 'Buy 6 NAD Supplement Pouches',
        defaultPrice: 14300,
        regularPriceOverride: 28800,
        tier: 'premium',
        isFeatured: true,
        badge: 'Best Value'
    }
];

// State management
let productsData = [];
let selectedProductIndex = 2; // Default to "Most Popular"
let countdownExpired = false;
let timeLeft = 5 * 60; // 5 minutes in seconds

// SVG Icons
const CHECKED_SVG = `
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="h-3 w-3">
<circle cx="12" cy="12" r="12" fill="#3b84f6" />
<path d="M20 6 9 17l-5-5" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;

const EMPTY_SVG = `
<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="h-3 w-3">
<circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2" />
</svg>`;

const STAR_ICON = `
<svg xmlns="http://www.w3.org/2000/svg" class="icon-pop" viewBox="0 0 20 20" fill="currentColor">
    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
</svg>`;

const THUMBS_ICON = `
<svg xmlns="http://www.w3.org/2000/svg" class="icon-pop" viewBox="0 0 20 20" fill="currentColor">
    <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"></path>
</svg>`;

// Format currency
function formatPrice(cents) {
    return `$${(cents / 100).toFixed(2)}`;
}

// Calculate discounted price
function calculateDiscountedPrice(regularPrice, discountPercent) {
    return Math.round(regularPrice * (1 - discountPercent / 100));
}

// Fetch product prices from backend/Stripe
async function fetchProductPrices() {
    try {
        // For demo purposes, using mock data
        // Replace this with actual API call to your backend
        // const response = await fetch('/api/products', { method: 'GET' });
        // const data = await response.json();
        
        // Mock data - replace with actual Stripe data
        return PRODUCT_CONFIG.map((config, index) => {
            const regularPrice = config.regularPriceOverride;
            const discountedPrice = calculateDiscountedPrice(regularPrice, config.discountPercent);
            const savings = regularPrice - discountedPrice;
            
            return {
                ...config,
                regularPrice,
                discountedPrice,
                savings,
                currentPrice: discountedPrice // Start with discounted price
            };
        });
    } catch (error) {
        console.error('Error fetching prices:', error);
        throw error;
    }
}

// Render package cards
function renderPackages() {
    const container = document.getElementById('packagesContainer');
    container.innerHTML = '';
    
    productsData.forEach((product, index) => {
        const isSelected = index === selectedProductIndex;
        const icon = isSelected ? CHECKED_SVG : EMPTY_SVG;
        const badgeIcon = product.badge === 'Most Popular' ? STAR_ICON : THUMBS_ICON;
        
        const card = document.createElement('div');
        card.className = `package-card${isSelected ? ' selected' : ''}`;
        card.dataset.index = index;

        let discountPct = 0;
        let savings = 0;

        if (product.regularPriceOverride > 0) {
            savings = product.regularPrice - product.defaultPrice;
            discountPct = savings / product.regularPriceOverride * 100;
        }

        card.innerHTML = `
            ${product.isFeatured ? `
            <div class="package-badge">
                ${badgeIcon}
                ${product.badge}
            </div>
            ` : ''}
            <div class="left">
                <div class="icon-check">
                    ${icon}
                </div>
                <div>
                    <h4>${product.name}</h4>
                    <p class="text-xs muted txt-discount">${discountPct.toFixed(0)}% Discount!</p>
                </div>
            </div>
            <div class="right">
                <div>
                    <span class="text-sm muted strike txt-reg">${formatPrice(product.regularPrice)}</span>
                    <span class="text-2xl semi-bold text-blue txt-price" data-product-index="${index}">
                        ${formatPrice(product.defaultPrice)}
                    </span>
                    <p class="text-xs text-green txt-save" data-savings-index="${index}">
                        You Save: ${formatPrice(savings)}
                    </p>
                </div>
            </div>
        `;
        
        card.addEventListener('click', () => selectPackage(index));
        container.appendChild(card);
    });
}

// Select package
function selectPackage(index) {
    selectedProductIndex = index;
    
    // Update selected state
    document.querySelectorAll('.package-card').forEach((card, i) => {
        card.classList.toggle('selected', i === index);
        
        // Update icon
        const iconContainer = card.querySelector('.icon-check');
        if (iconContainer) {
            iconContainer.innerHTML = i === index ? CHECKED_SVG : EMPTY_SVG;
        }
    });
}

// Update prices when countdown expires
function expireDiscount() {
    countdownExpired = true;
    
    // Update banner
    const bannerText = document.getElementById('bannerText');
    if (bannerText) {
        bannerText.textContent = 'Discount has expired. Regular pricing applies.';
    }
    
    const countdownEl = document.getElementById('countdown');
    if (countdownEl) {
        countdownEl.textContent = '00:00';
        countdownEl.classList.add('expired');
    }
    
    // Update all product prices to regular prices
    productsData.forEach((product, index) => {
        product.currentPrice = product.regularPrice;
        product.savings = 0;
        
        // Update price display
        const priceEl = document.querySelector(`[data-product-index="${index}"]`);
        if (priceEl) {
            priceEl.textContent = formatPrice(product.regularPrice);
        }
        
        // Update savings display
        const savingsEl = document.querySelector(`[data-savings-index="${index}"]`);
        if (savingsEl) {
            savingsEl.textContent = 'Regular Price';
            savingsEl.classList.remove('text-green');
            savingsEl.classList.add('muted');
        }
        
        // Hide discount percentages
        const discountEls = document.querySelectorAll('.txt-discount');
        discountEls.forEach(el => {
            el.style.display = 'none';
        });
    });
}

// Countdown timer
function updateCountdown() {
    if (countdownExpired) return;
    
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    
    const countdownElement = document.getElementById('countdown');
    if (countdownElement) {
        countdownElement.textContent = 
            String(minutes).padStart(2, '0') + ':' + String(seconds).padStart(2, '0');
    }
    
    if (timeLeft > 0) {
        timeLeft--;
    } else {
        expireDiscount();
    }
}

// Handle purchase button
function handlePurchase() {
    const selectedProduct = productsData[selectedProductIndex];
    if (!selectedProduct) return;
    
    console.log('Selected product:', selectedProduct);
    alert(`Proceeding to checkout with: ${selectedProduct.name}\nPrice: ${formatPrice(selectedProduct.currentPrice)}`);
    
    // Here you would integrate with your actual checkout system
    // Example: window.location.href = `/checkout?product=${selectedProduct.stripeProductId}&price=${selectedProduct.currentPrice}`;
}

// Initialize app
async function initApp() {
    try {
        // Show loading state
        document.getElementById('loadingState').style.display = 'block';
        document.getElementById('mainContent').style.display = 'none';
        document.getElementById('errorState').style.display = 'none';
        
        // Fetch product prices
        productsData = await fetchProductPrices();
        
        // Render packages
        renderPackages();
        
        // Set up purchase button
        const purchaseBtn = document.getElementById('purchase-btn');
        if (purchaseBtn) {
            purchaseBtn.addEventListener('click', handlePurchase);
        }
        
        // Start countdown
        updateCountdown();
        setInterval(updateCountdown, 1000);
        
        // Set copyright year
        const yearEl = document.getElementById('year');
        if (yearEl) {
            yearEl.textContent = new Date().getFullYear();
        }
        
        // Show main content
        document.getElementById('loadingState').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
        
    } catch (error) {
        console.error('Initialization error:', error);
        document.getElementById('loadingState').style.display = 'none';
        document.getElementById('errorState').style.display = 'block';
    }
}

// Start app when DOM is ready
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initApp);
} else {
    initApp();
}
    </script>
</body>
</html>