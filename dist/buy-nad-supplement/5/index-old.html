<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best NAD Supplement in 2025 | Anti-Aging & Energy Boost</title>
    <meta name="description" content="Transform your health with premium NAD+ supplement. Maintain youthful skin, boost energy and focus. Free shipping + 30-day money-back guarantee. Order now!">
    <link rel="icon" type="image/x-icon" href="images/logo.png">
    
    <!-- DNS prefetch for even earlier DNS resolution -->
    <link rel="dns-prefetch" href="//fonts.juniorbay.com">
    <link rel="dns-prefetch" href="//juniorbay.net">

    <!-- <link rel="preconnect" href="https://fonts.juniorbay.com"> -->
    <link rel="preconnect" href="https://juniorbay.net" crossorigin>
    <link href="https://fonts.juniorbay.com/?family=Aileron:400,600&family=Quicksand:700&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 217 91% 60%;
            --primary-foreground: 0 0% 100%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 217 91% 60%;
            --accent-foreground: 0 0% 100%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 217 91% 60%;
            --urgency: 0 100% 50%;
            --urgency-foreground: 0 0% 100%;
            --success: 142 76% 36%;
            --success-foreground: 0 0% 100%;
            --warning: 45 93% 58%;
            --warning-foreground: 222.2 84% 4.9%;
            --radius: 1rem;
        }

        html {
            font-size: 62.5%;
        }

        body {
            font-family: Aileron;
            font-weight: 400;
            font-size: 1.6rem;
        };

        p {
            font-family: Aileron, sans-serif;
            font-weight: 400;
        }

        h1 {
            font-family: Quicksand, Tahoma, sans-serif;
            font-weight: 700;
            font-size: 4rem;
        }

        h2 {
            font-family: Quicksand, Tahoma, sans-serif;
            font-size: 3.8rem;
            font-weight: 700;;
            margin-bottom: 1.5rem;
        }

        h3 {
            font-family: Quicksand, Tahoma, sans-serif;
            font-size: 2.4rem;
            font-weight: 700;
            line-height: 3.8rem;
            margin-bottom: 1.5rem;
        }

        h4 {
            font-family: Quicksand, sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 2.9rem;
            /* margin-bottom: 1.5rem; */
        }

        h5 {
            font-family: Quicksand, sans-serif;
            font-size: 3rem;
            font-weight: 700;
        }

        .banner-red {
            padding: 1.5rem 1rem;
            background-color: hsl(var(--urgency));
            color: hsl(var(--urgency-foreground));
        }

        .banner-blue {
            padding: 1.5rem 1rem;
            background-color: #0b5294;
            color: #ffffff;
        }

        .banner-green {
            background-color: hsl(var(--success));
            padding: 1.5rem 1rem;
        }

        .font-mono {
            color: #ffef03;
        }

        .box {
            margin: 0;
            padding: 0;
        }

        .bg-image {
            height: 50rem;
            width: 100%;
            background-image: url("images/product-bg.png");
            background-size: cover;
            flex: 1;
            border-radius: 1rem;
        }

        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            padding: 2rem;
        }

        .antipodal-container {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .straight-container {
            max-width: 75%;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .bordered-container {
            max-width: 75%;
            margin: 0 auto;
            padding: 0 1rem;
            border: 1px solid #c0c0c0;
            background-color: #f2f2f2;
        }

        .row {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .row-75 {
            max-width: 75%;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
        }

        .icon {
            width: 3rem;
            height: 3rem;
        }

        .icon-lock {
            width: 2rem;
            height: 2rem;
            fill: currentColor;
        }

        .icon-pop {
            width: 1.3rem;
            height: 1.3rem;
            fill: currentColor;
        }

        .icon-form {
            width: 2rem;
            height: 2rem;
            fill: currentColor;
        }

        label {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .badge {
            position: absolute;
            top: -1rem;
            right: -1rem;
            background-color: #f7c72f;
            color: #010915;
            padding: 0.895rem 1.5rem;
            border-radius: 999.9rem;
            font-weight: 600;
            font-family: Aileron;
            font-size: 1.2rem;
        }

        .pod {
            padding: 3rem;
        }

        .box-light {
            border: 1px solid #c0c0c0;
            border-radius: 1rem;
            max-width: 25rem;
            margin: 2rem 0;
        }

        .showcase {
            max-width: 80%;
            margin: 0 auto;
        }

        .select-item {
            background-color: #f1f5f9;
            padding: 4rem 4rem;
        }

        .package-card {
            padding: 3rem;
            border: 2px solid #e2e8f0;
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            justify-content: space-between;
            margin-bottom: 2.8rem;
        }

        .package-card:hover {
            border-color: hsl(var(--success));
            background-color: hsl(var(--success) / 0.05);
        }

        .package-card.selected {
            border-color: hsl(var(--primary));
            background-color: hsl(var(--primary) / 0.05);
        }

        .package-badge {
            position: absolute;
            top: -1.3rem;
            right: -1rem;
            background-color: hsl(var(--warning));
            color: hsl(var(--warning-foreground));
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-family: Aileron, sans-serif;
            font-weight: 600;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
        }


        .left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .right {
            text-align: right;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1.5rem;
            border-radius: var(--radius);
            font-weight: 600;
            font-family: Aileron;
            transition: all 0.2s;
            border: none;
            cursor: pointer;
            text-decoration: none;
        }

        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }

        .btn-primary:hover {
            background-color: hsl(var(--success) / 0.9);
        }

        form fieldset {
            border: none;
            /* border-bottom: 2px dotted #d0d0d0; */
            margin: 2.5rem 0;
        }

        /* Base styling for form inputs */
        .input,
        #card-element, /* Stripe card input container */
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="password"],
        textarea,
        select {
        width: 100%;
        padding: 16px 18px;
        margin-bottom: 16px;
        border: 2px solid #64758b; /* gray-blue outline */
        border-radius: 6px;
        font-size: 1rem;
        line-height: 1.4;
        background-color: #fff;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        /* Focused input state */
        .input:focus,
        #card-element:focus-within,
        input:focus,
        textarea:focus,
        select:focus {
        outline: none;
        border-color: #3b84f6; /* blue accent color */
        box-shadow: 0 0 0 3px rgba(59, 132, 246, 0.25);
        }

        /* Button â€” match input height for rhythm */
        button,
        .btn,
        input[type="submit"] {
        padding: 16px;
        font-size: 1rem;
        border-radius: 6px;
        border: none;
        background-color: #3b84f6;
        color: #fff;
        cursor: pointer;
        transition: filter 0.2s ease;
        }
        button:hover,
        .btn:hover,
        input[type="submit"]:hover {
        filter: brightness(1.1);
        }

        /* Checkout Input Styles */
        #card-element {
            width: 100%;
            padding: 1.2rem 1rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        .input-shop {
            width: 100%;
            padding: 1.2rem 1rem;
            border: none;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        .input-shop:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }

        .form-guarantee {
            display: flex;
            justify-content: center;
            margin-top: 3rem;
        }

        .form-guarantee img {
            max-width: 8rem;
            max-height: 8rem;
        }

        .card-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .pay-with-card {
            width: auto;
            height: 20px;
        }

        footer {
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #0b5294;
            color: #ffffff;
        }

        .footer-links {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }

        .link, 
        .footer-links a {
            color: #ff8309;
            text-decoration: none;
        }

        .footer-links a:hover {
            color: #ffffff;
            text-decoration: underline;
        }

        .customer {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 2rem;
            /* margin-bottom: 1.5rem; */
        }

        .csz {
            display: grid;
            grid-template-columns: repeat(3, minmax(0, 1fr));
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .chk {
            display:flex;
            align-items:center;
            gap:0.5rem;
            cursor:pointer;
            margin-bottom:3rem;
        }

        #order-summary { 
            margin: 20px 0;
        }

        .main-img {
            width: 50rem;
            height: 50rem;
        }

        .grand-total {
            background-color: #fee301;
            padding: 0.5rem 1rem;
        }

        .flex-1 { flex: 1; }

        .center { text-align: center; }

        .hidden { display: none; }

        .w-full { width: 100%; }
        .relative { position: relative; }
        .rounded-lg { border-radius: 1.5rem; }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.05); }

        .text-xs {font-size: 1.2rem;}
        .text-sm {font-size: 1.4rem;}
        .text-md {font-size: 1.6rem;}
        .text-lg {font-size: 1.8rem;}
        .text-xl {font-size: 2.2rem;}
        .text-2xl {font-size: 2.6rem;}

        .mb-2 {margin-bottom: 2rem;}
        .mb-3 {margin-bottom: 3rem;}
        .mb-4 {margin-bottom: 4rem;}
        .mb-5 {margin-bottom: 5rem;}

        /* .text-line{display: block;} */

        .text-blue { color: #4285F4;}
        .text-green { color: #1ba24c; }
        .text-red { color: hsl(var(--urgency)); }


        .muted { color: hsl(var(--muted-foreground)); }
        .strike { text-decoration: line-through; }

        .semi-bold { font-weight: 600; }
        .bold { font-weight: bold; }

        .grid { display: grid; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }

        .break { margin-bottom: 2rem; }

        .trust {
            display: grid;
            grid-template-columns: repeat(4, minmax(0, 1fr));
            justify-content: space-between;
            align-items: center;
            padding: 2rem 0;
        }

        .striped-container .stripe-item:nth-child(odd) {
            background-color: #f2f2f2; /* Light grey for odd rows */
        }

        .striped-container .stripe-item:nth-child(even) {
            background-color: #ffffff;
        }

        #last {
            margin-bottom: -0.025rem;
        }

        /* Optional: Add some padding or styling for better visual appearance */
        .stripe-item {
            padding: 1rem;
            margin-bottom: 0.5rem;
        }

        .bordered {
            border: 2px solid #c0c0c0;
        }

        .seal-image {
            width: 12rem;
            height: 12rem;
        }

        .guarantee-text {
            color: #ffffff;
        }

        .ribbon-split {
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url("images/ribbon.png");
            gap: 3rem;
            padding: 2rem 4rem;
        }

        /* Gradient Backgrounds */
        .bg-gradient {
            background: linear-gradient(135deg, hsl(var(--muted) / 0.5), hsl(var(--muted)));
        }

        /* =========================================
        RESPONSIVE MEDIA QUERIES
        ========================================= */

        /* 1024px and below (Laptops, smaller desktops) */
        @media (max-width: 1024px) {
        .straight-container,
        .bordered-container,
        .row-75,
        .showcase {
            max-width: 100%;
        }

        .main-img {
            width: 40rem;
            height: 40rem;
        }
        }

        /* Tablets (768px and below) */
        @media (max-width: 768px) {
        /* .antipodal-container {
            flex-direction: row;
            align-items: flex-start;
            gap: 1rem;
        } */

        .customer,
        .csz {
            grid-template-columns: 1fr;
        }

        .trust {
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .main-img {
            width: 35rem;
            height: 35rem;
        }
        }

        /* Small Tablets and Large Phones (600px and below) */
        @media (max-width: 600px) {
        .row,
        .row-75,
        .container {
            flex-direction: column;
            justify-content: center;
        }

        .box .container {
            flex-direction: row;
        }

        .package-card {
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .footer-links {
            flex-direction: row;
            gap: 0.5rem;
        }

        .main-img {
            width: 28rem;
            height: 28rem;
        }
        }

        /* Mobile Phones (480px and below) */
        @media (max-width: 480px) {
        h1 { font-size: 2rem; }
        h2 { font-size: 2.6rem; text-align: center; }
        h3 { font-size: 2rem; }
        h4 { font-size: 1.4rem; }

        /* body {
            font-size: 65%;
        } */

        .icon,
        .icon-cart {
            width: 2.5rem;
            height: 2.5rem;
            flex-shrink: 0;
        }

        .box-light {
            max-width: 15rem;
            margin: 1rem 0;
            text-align: center;
        }

        .package-card {
            padding: 3rem 1.3rem;
            width: 100%;
        }

        .package-badge {
            font-size: 1rem;
        }

        .text-sm {
            font-size: 1rem;
        }

        .text-xs {
            font-size: 1rem;
        }

        .text-2xl {
            font-size: 2rem;
        }

        .ribbon-split {
            flex-direction: row;
            gap: 1.5rem;
            padding: 1rem;
        }

        .seal-image {
            width: 14rem;
            height: 14rem;
        }

        .main-img {
            width: 35rem;
            height: 35rem;
        }

        .text-md {font-size: 1.2rem;}
        }

        /* Small Mobile Phones (360px and below) */
        @media (max-width: 359px) {
        h1 { font-size: 2.4rem; }
        h2 { font-size: 2.2rem; }
        h3 { font-size: 1.8rem; }
        h4 { font-size: 0.95rem; }

        /* .icon-check {
            display: none;
        } */

        .package-card {
            flex-direction: column;
            align-items: center;
        }

        .left {
            text-align: center;
            flex-direction: column;
            align-items: center;
            gap: 0.75rem;
        }

        .right {
            text-align: center;
        }


        .btn,
        button,
        input[type="submit"] {
            padding: 1.2rem;
            font-size: 0.9rem;
        }

        .main-img {
            width: 28rem;
            height: 28rem;
        }

        .badge {
            right: 1rem;
            padding: 0.5rem 1rem;
            font-weight: 600;
            font-size: 0.85rem;
        }
        }

        /* Landscape Orientation Adjustments for Mobile */
        @media (max-width: 768px) and (orientation: landscape) {
        .main-img {
            max-height: 20rem;
            width: auto;
        }

        footer {
            flex-direction: row;
            justify-content: space-between;
            padding: 1rem;
        }
        }

        /* High DPI / Retina Display Adjustments */
        @media only screen 
        and (min-device-pixel-ratio: 2),
        only screen 
        and (min-resolution: 192dpi) {
        .bg-image {
            background-image: url("images/product-bg@2x.png");
            background-size: cover;
        }

        /* .seal img {
            width: 14rem;
            height: 14rem;
        } */
        }
    </style>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Product",
        "@id": "#nad-supplement",
        "name": "NAD+ Nicotinamide Riboside",
        "description": "Maintain youthful skin, boost focus & energy with our premium NAD supplementâ€”the celebrity secret to fighting the effects of aging.",
        "category": "Dietary Supplement",
        "itemCondition": "https://schema.org/NewCondition",
        "image": [
            "https://images.juniorbay.com/photos/0CqHGmpUmdE/large.jpg"
        ],
        "offers": {
            "@type": "AggregateOffer",
            "priceCurrency": "USD",
            "lowPrice": "33.00",
            "highPrice": "143.00",
            "offerCount": "4",
            "availability": "https://schema.org/InStock",
            "offers": [
            {
                "@type": "Offer",
                "priceCurrency": "USD",
                "price": "33.00",
                "availability": "https://schema.org/InStock",
                "itemCondition": "https://schema.org/NewCondition",
                "name": "Buy 1 NAD Supplement Pouch"
            },
            {
                "@type": "Offer",
                "priceCurrency": "USD",
                "price": "59.00",
                "availability": "https://schema.org/InStock",
                "itemCondition": "https://schema.org/NewCondition",
                "name": "Buy 2 NAD Supplement Pouches"
            },
            {
                "@type": "Offer",
                "priceCurrency": "USD",
                "price": "83.00",
                "availability": "https://schema.org/InStock",
                "itemCondition": "https://schema.org/NewCondition",
                "name": "Buy 3 NAD Supplement Pouches"
            },
            {
                "@type": "Offer",
                "priceCurrency": "USD",
                "price": "143.00",
                "availability": "https://schema.org/InStock",
                "itemCondition": "https://schema.org/NewCondition",
                "name": "Buy 6 NAD Supplement Pouches"
            }
            ],
            "shippingDetails": [
            {
                "@type": "OfferShippingDetails",
                "shippingRate": {
                    "@type": "MonetaryAmount",
                    "value": "0",
                    "currency": "USD"
                },
                "shippingDestination": {
                    "@type": "DefinedRegion",
                    "addressCountry": "US"
                }
            }
            ],
            "hasMerchantReturnPolicy": {
                "@type": "MerchantReturnPolicy",
                "returnPolicyCategory": "https://schema.org/MerchantReturnFiniteReturnWindow",
                "merchantReturnDays": 30,
                "returnFees": "https://schema.org/FreeReturn",
                "returnMethod": "https://schema.org/ReturnByMail"
            }
        }
    }
    </script>
    <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
    <div class="min-h-screen">
        <!-- Urgency Banner -->
        <div class="banner-red">
            <div class="box">
                <p class="text-sm semi-bold center">
                    ðŸ”¥ Up to 50% discount applied. This code expires in: <span id="countdown" class="font-mono font-bold">05:00</span> - Please do not leave this page!
                </p>
            </div>
        </div>

        <!-- Header -->
        <header>
            <div class="box">
                <div class="container">     
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-cart icon-solid" viewBox="0 0 20 20" fill="currentColor">
                        <path d="M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"></path>
                    </svg>
                    <h1>NAD Supplement</h1>
                </div>
            </div>
        </header>

        <main>
            <!-- Product Showcase -->
            <section class="showcase">
                <div class="container">
                    <div class="box">
                        <!-- Product Image -->
                        <div class="relative">
                            <div class="bg-gradient rounded-lg shadow-lg">
                                <img 
                                    src="images/1-pouch.png" 
                                    alt="Liposomal - NAD Supplement" 
                                    class="main-img rounded-lg"
                                />
                            </div>
                            
                            <!-- Trust Badge -->
                            <div class="badge">
                                High Purity
                            </div>
                        </div>
                    </div>

                    <!-- Product Info -->
                    <div class="pod">
                        <div class="mb-6">
                            <h2 class="text-4xl font-bold mb-2">NAD+ Nicotinamide Riboside with Resveratrol</h2>
                            <p class="text-lg muted">
                                Reverse the effects of aging with NAD+ Supplement, which boosts cellular vitality by restoring NAD, the fuel needed for cellular repair. 
                            </p>
                        </div>

                        <!-- Features Grid -->
                        <div class="grid grid-cols-2 gap-6">
                            <div class="container box-light">            
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 20 20" fill="#4285F4">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-2 0c0 .993-.241 1.929-.668 2.754l-1.524-1.525a3.997 3.997 0 00.078-2.183l1.562-1.562C15.802 8.249 16 9.1 16 10zm-5.165 3.913l1.58 1.58A5.98 5.98 0 0110 16a5.976 5.976 0 01-2.516-.552l1.562-1.562a4.006 4.006 0 001.789.027zm-4.677-2.796a4.002 4.002 0 01-.041-2.08l-.08.08-1.53-1.533A5.98 5.98 0 004 10c0 .954.223 1.856.619 2.657l1.54-1.54zm1.088-6.45A5.974 5.974 0 0110 4c.954 0 1.856.223 2.657.619l-1.54 1.54a4.002 4.002 0 00-2.346.033L7.246 4.668zM12 10a2 2 0 11-4 0 2 2 0 014 0z" clip-rule="evenodd"></path>
                                </svg>
                                <div>
                                    <p class="text-sm text-muted-foreground">Helps maintain youthful skin appearance</p>
                                </div>
                            </div>
                            <div class="container box-light">              
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="#4285F4" class="icon">
                                    <path fill-rule="evenodd" d="M12 6.75a5.25 5.25 0 016.775-5.025.75.75 0 01.313 1.248l-3.32 3.319c.063.475.276.934.641 1.299.365.365.824.578 1.3.64l3.318-3.319a.75.75 0 011.248.313 5.25 5.25 0 01-5.472 6.756c-1.018-.086-1.87.1-2.309.634L7.344 21.3A3.298 3.298 0 112.7 16.657l8.684-7.151c.533-.44.72-1.291.634-2.309A5.342 5.342 0 0112 6.75zM4.117 19.125a.75.75 0 01.75-.75h.008a.75.75 0 01.75.75v.008a.75.75 0 01-.75.75h-.008a.75.75 0 01-.75-.75v-.008z" clip-rule="evenodd"></path>
                                    <path d="M10.076 8.64l-2.201-2.2V4.874a.75.75 0 00-.364-.643l-3.75-2.25a.75.75 0 00-.916.113l-.75.75a.75.75 0 00-.113.916l2.25 3.75a.75.75 0 00.643.364h1.564l2.062 2.062 1.575-1.297z"></path>
                                    <path fill-rule="evenodd" d="M12.556 17.329l4.183 4.182a3.375 3.375 0 004.773-4.773l-3.306-3.305a6.803 6.803 0 01-1.53.043c-.394-.034-.682-.006-.867.042a.589.589 0 00-.167.063l-3.086 3.748zm3.414-1.36a.75.75 0 011.06 0l1.875 1.876a.75.75 0 11-1.06 1.06L15.97 17.03a.75.75 0 010-1.06z" clip-rule="evenodd"></path>
                                </svg>
                                <div>
                                    <p class="text-sm text-muted-foreground">Fix your body's broken parts quicker</p>
                                </div>
                            </div>
                            <div class="container box-light">
                                <svg class="icon" viewBox="0 0 24 24" fill="none">
                                    <rect x="5" y="5" width="14" height="14" rx="2" ry="2" fill="#FFFFFF"/>
                                    <rect x="9" y="5" width="6" height="14" fill="#4285F4"/>
                                    <rect x="5" y="9" width="14" height="6" fill="#4285F4"/>
                                </svg>
                                <div>
                                    <p class="text-sm text-muted-foreground">Makes your brain sharp, so you can learn better</p>
                                </div>
                            </div>
                            <div class="container box-light">
                                <svg class="h-8 w-8 text-primary flex-shrink-0 icon" viewBox="0 0 24 24" stroke-width="2">
                                    <g transform="translate(12, 12)"> 
                                        <circle cx="0" cy="0" r="4" fill="#4285F4" stroke="#4285F4"/>
                                        
                                        <circle cx="0" cy="-7" r="2.5" fill="#4285F4" stroke="#4285F4"/>
                                        <line x1="0" y1="-4" x2="0" y2="-7" stroke="#4285F4" stroke-linecap="round"/>
                                        
                                        <circle cx="-6" cy="3.5" r="2.5" fill="#4285F4" stroke="#4285F4"/>
                                        <line x1="-3.46" y1="2" x2="-6" y2="3.5" stroke="#4285F4" stroke-linecap="round"/>
                                        
                                        <circle cx="6" cy="3.5" r="2.5" fill="#4285F4" stroke="#4285F4"/>
                                        <line x1="3.46" y1="2" x2="6" y2="3.5" stroke="#4285F4" stroke-linecap="round"/>
                                    </g>
                                </svg>
                                <div>
                                    <p class="text-sm text-muted-foreground">Give your body energy to run and play</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Package Selector -->
            <section class="select-item">
                <div class="straight-container mx-auto">
                    <div class="text-center mb-8">
                        <h3 class="center">Choose Your Package</h3>
                    </div>
                    
                    <div class="box">
                        <div class="package-card" data-package="basic" id="prod_SxJKn7l9FUAD0B">
                            <div class="left">
                                <div class="icon-check">
                                    <svg xmlns="http://www.w3.org/2000/svg" 
                                        width="24" height="24" viewBox="0 0 24 24" 
                                        class="h-3 w-3">

                                    <!-- Circle outline only -->
                                    <circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2" />
                                    </svg>
                                </div>
                                <div>
                                    <h4>Product 1</h4>
                                    <p class="text-xs muted txt-discount">discount percent</p>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <span class="text-sm muted strike txt-reg">regular price</span>
                                    <span id="price1" class="text-2xl semi-bold text-blue txt-price">discounted price</span>
                                    <p class="text-xs text-green txt-save">savings</p>
                                </div>
                            </div>
                        </div>

                        <div class="package-card" data-package="medium" id="prod_SxJVoQYlPT173d">
                            <div class="left">
                                <div class="icon-check">
                                    <svg xmlns="http://www.w3.org/2000/svg" 
                                        width="24" height="24" viewBox="0 0 24 24" 
                                        class="h-3 w-3">

                                    <!-- Circle outline only -->
                                    <circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2" />
                                    </svg>
                                </div>
                                <div>
                                    <h4>Product 2</h4>
                                    <p class="text-xs muted txt-discount">discount percent</p>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <span class="text-sm muted strike txt-reg">regular price</span>
                                    <span class="text-2xl semi-bold text-blue txt-price">discounted price</span>
                                    <p class="text-xs text-green txt-save">savings</p>
                                </div>
                            </div>
                        </div>

                        <div class="package-card selected" data-package="popular" id="prod_SxJgASmAPdNEgf">
                            <div class="package-badge">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-pop" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                </svg>
                                Most Popular
                            </div>
                            <div class="left">
                                <div class="icon-check">
                                    <svg xmlns="http://www.w3.org/2000/svg" 
                                        viewBox="0 0 24 24" 
                                        class="icon-star">

                                        <!-- Solid blue circle (no stroke) -->
                                        <circle cx="12" cy="12" r="12" fill="#3b84f6" />

                                        <!-- White check mark -->
                                        <path d="M20 6 9 17l-5-5" 
                                                fill="none" stroke="#ffffff" stroke-width="2" 
                                                stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div>
                                    <h4>Product 3</h4>
                                    <p class="text-xs muted txt-discount">discount percent</p>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <span class="text-sm muted strike txt-reg">regular price</span>
                                    <span class="text-2xl semi-bold text-blue txt-price">$discounted price</span>
                                    <p class="text-xs text-green txt-save">savings</p>
                                </div>
                            </div>
                        </div>

                        <div class="package-card" data-package="premium" id="prod_SxK4r0sm7rKRnx">
                            <div class="package-badge">         
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-pop" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"></path>
                                </svg>
                                Best Value
                            </div>
                            <div class="left">
                                <div class="icon-check">
                                    <svg xmlns="http://www.w3.org/2000/svg" 
                                        width="24" height="24" viewBox="0 0 24 24" 
                                        class="h-3 w-3">

                                    <!-- Circle outline only -->
                                    <circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2" />
                                    </svg>
                                </div>
                                <div>
                                    <h4>Product 4</h4>
                                    <p class="text-xs muted txt-discount">discount percent</p>
                                </div>
                            </div>
                            <div class="right">
                                <div>
                                    <span class="text-sm muted strike txt-reg">regular price</span>
                                    <span class="text-2xl semi-bold text-blue txt-price">discounted price</span>
                                    <p class="text-xs text-green txt-save">savings</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="center">
                        <button id="purchase-btn" class="btn btn-primary text-lg">
                            Order Now
                        </button>
                    </div>
                </div>
            </section>

            <!-- Customer Form -->
            <form id="payment-form" class="hidden">
                <div class="row-75 banner-blue">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"></path>
                    </svg>
                    <h5>Secure Checkout</h5>
                </div>
                <section class="bordered-container">
                    <div class="row">&nbsp</div>
                    <div class="straight-container" id="stripe-form">
                        <div class="customer">
                            <fieldset>
                                <label for="firstName" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon-form icon-user icon-outline" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                    First Name
                                </label>
                                <input type="text" id="firstName" name="firstName" class="input-shop" required />
                            </fieldset>
                            <fieldset>
                                <label for="lastName" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="icon-form icon-users icon-solid" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"></path>
                                    </svg>
                                    Last Name
                                </label>
                                <input type="text" id="lastName" name="lastName" class="input-shop" required>
                            </fieldset>
                        </div>

                        <fieldset>
                            <label for="email" class="text-md">   
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-form icon-mail-new icon-solid" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                                </svg>
                                Email Address
                            </label>
                            <input type="email" id="email" name="email" class="input-shop" required>
                        </fieldset>

                        <fieldset>
                            <label for="phone" class="text-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-form icon-phone icon-outline" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                                Phone Number
                            </label>
                            <input type="tel" id="phone" name="phone" class="input-shop" required>
                        </fieldset>

                        <div class="card-info">
                            <h3 class="text-xl font-semibold" style="margin-top: 8px;">Card Information</h3> 
                            <img src="images/visa-mstr-disc.png" class="pay-with-card" style="display: block;" />
                        </div>
                        <div id="card-element"></div>

                        <h3 class="mb-4">Billing Address</h3>
                        <fieldset>
                            <label for="address" class="text-md">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-id icon-solid">
                                    <path fill-rule="evenodd" d="M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z" clip-rule="evenodd"></path>
                                </svg>
                                Street Address
                            </label>
                            <input type="text" id="address" class="input-shop" required>
                        </fieldset>
                        <fieldset>
                            <label for="address2" class="text-md">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-id icon-solid">
                                    <path fill-rule="evenodd" d="M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z" clip-rule="evenodd"></path>
                                </svg>
                                Apartment, suite, etc. (optional)
                            </label>
                            <input type="text" id="address2" class="input-shop">
                        </fieldset>
                        <div class="csz">
                            <fieldset>
                                <label for="city" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-id icon-solid">
                                        <path fill-rule="evenodd" d="M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z" clip-rule="evenodd"></path>
                                    </svg>
                                    City
                                </label>
                                <input type="text" id="city" class="input-shop" required>
                            </fieldset>
                            <fieldset>
                                <label for="state" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-id icon-solid">
                                        <path fill-rule="evenodd" d="M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z" clip-rule="evenodd"></path>
                                    </svg>
                                    State
                                </label>
                                <input type="text" id="state" class="input-shop" required>
                            </fieldset>
                            <fieldset>
                                <label for="zip" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-id icon-solid">
                                        <path fill-rule="evenodd" d="M4.5 3.75a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V6.75a3 3 0 0 0-3-3h-15Zm4.125 3a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Zm-3.873 8.703a4.126 4.126 0 0 1 7.746 0 .75.75 0 0 1-.351.92 7.47 7.47 0 0 1-3.522.877 7.47 7.47 0 0 1-3.522-.877.75.75 0 0 1-.351-.92ZM15 8.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15ZM14.25 12a.75.75 0 0 1 .75-.75h3.75a.75.75 0 0 1 0 1.5H15a.75.75 0 0 1-.75-.75Zm.75 2.25a.75.75 0 0 0 0 1.5h3.75a.75.75 0 0 0 0-1.5H15Z" clip-rule="evenodd"></path>
                                    </svg>
                                    Zip Code
                                </label>
                                <input type="text" id="zip" class="input-shop" required>
                            </fieldset>
                        </div>

                        <label class="chk text-sm">
                            <input type="checkbox" id="same-as-billing">
                            <span>Shipping address is the same as billing address (uncheck to add a shipping address)</span>
                        </label>

                        <section id="shipping-section">
                            <h3 class="mb-4">Shipping Address</h3>
                            <fieldset>
                                <label for="shipping-address" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-truck icon-solid">
                                        <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"></path>
                                        <path d="M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"></path>
                                        <path d="M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
                                    </svg>
                                    Street Address
                                </label>
                                <input type="text" id="shipping-address" class="input-shop" required>
                            </fieldset>
                            <fieldset>
                                <label for="shipping-address2" class="text-md">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-truck icon-solid">
                                        <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"></path>
                                        <path d="M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"></path>
                                        <path d="M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
                                    </svg>
                                    Apartment, suite, etc. (optional)
                                </label>
                                <input type="text" id="shipping-address2" class="input-shop">
                            </fieldset>
                            <div class="csz">
                                <fieldset>
                                    <label for="shipping-city" class="text-md">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-truck icon-solid">
                                            <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"></path>
                                            <path d="M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"></path>
                                            <path d="M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
                                        </svg>
                                        City
                                    </label>
                                    <input type="text" id="shipping-city" class="input-shop" required>
                                </fieldset>
                                <fieldset>
                                    <label for="shipping-state" class="text-md">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-truck icon-solid">
                                            <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"></path>
                                            <path d="M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"></path>
                                            <path d="M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
                                        </svg>
                                        State
                                    </label>
                                    <input type="text" id="shipping-state" class="input-shop" required>
                                </fieldset>
                                <fieldset>
                                    <label for="shipping-zip" class="text-md">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="icon-form icon-truck icon-solid">
                                            <path d="M3.375 4.5C2.339 4.5 1.5 5.34 1.5 6.375V13.5h12V6.375c0-1.036-.84-1.875-1.875-1.875h-8.25ZM13.5 15h-12v2.625c0 1.035.84 1.875 1.875 1.875h.375a3 3 0 1 1 6 0h3a.75.75 0 0 0 .75-.75V15Z"></path>
                                            <path d="M8.25 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM15.75 6.75a.75.75 0 0 0-.75.75v11.25c0 .087.015.17.042.248a3 3 0 0 1 5.958.464c.853-.175 1.522-.935 1.464-1.883a18.659 18.659 0 0 0-3.732-10.104 1.837 1.837 0 0 0-1.47-.725H15.75Z"></path>
                                            <path d="M19.5 19.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0Z"></path>
                                        </svg>
                                        Zip Code
                                    </label>
                                    <input type="text" id="shipping-zip" class="input-shop" required>
                                </fieldset>
                            </div>
                        </section>

                        <section id="order-summary" class="striped-container">
                            <h3 class="center">Order Summary</h3>
                            <div class="bordered">
                                <div class="antipodal-container text-sm stripe-item">
                                    <span>Regular Price</span>
                                    <span id="os-regular" class="text-gray-800 font-medium">â€”</span>
                                </div>
                                <div class="antipodal-container text-sm stripe-item">
                                    <span>Discount</span>
                                    <span id="os-discount" class="font-semibold text-red">â€”</span>
                                </div>
                                <div class="antipodal-container text-sm stripe-item">
                                    <span>Estimated Tax</span>
                                    <span id="os-tax" class="muted"></span>
                                </div>
                                <div class="antipodal-container text-sm stripe-item">
                                    <span>Shipping</span>
                                    <span id="os-ship" class="muted">Free</span>
                                </div>
                                <div class="antipodal-container text-sm bold stripe-item" id="last">
                                    <span>You Pay</span>
                                    <span id="os-final" class="text-blue text-2xl">â€”</span>
                                </div>
                            </div>
                            <div class="container">&nbsp;</div>
                            <button type="submit" id="submit-button" class="btn btn-primary w-full text-lg py-3">
                                Complete Checkout
                            </button>

                            <div id="error-message" class="text-sm" style="color:#dc3545;display:none;"></div>
                            <div id="success-message" class="text-sm" style="color:#155724;display:none;"></div>
                        </section>
                    </div>
                </section>
            </form>
        </main>

        <!-- Trust Indicators -->
        <section>
            <div class="straight-container">
                <div class="trust">
                    <div class="center">
                        <img src="images/30-day.png" alt="30-Day Money-Back Guarantee" height="80px" />
                        <h3 class="semi-bold text-sm">30-Day Guarantee</h3>
                    </div>
                    
                    <div class="center">
                        <img src="images/free-delivery.png" alt="Free Shipping" height="80px" />
                        <h3 class="font-semibold text-sm mb-1">Free Shipping</h3>
                    </div>
                    
                    <div class="center">
                        <img src="images/ssl_encrypt.png" alt="Secure Payment" height="80px" />
                        <h3 class="font-semibold text-sm mb-1">Secure Payment</h3>
                    </div>
                    
                    <div class="center">
                        <img src="images/certified-quality.png" alt="Certified Quality" height="80px" />
                        <h3 class="font-semibold text-sm mb-1">Quality Certified</h3>
                    </div>
                </div>
            </div>
        </section>

        <section class="guarantee">
            <div class="ribbon-split">
                <div class="seal">
                    <img src="images/money-back.png" alt="Money Back Seal" class="seal-image">
                </div>
                <div class="guarantee-text">
                    <p class="text-sm">This product is backed by a 30-day money-back guarantee. 
                        If you're not totally and completely satisfied with this product, 
                        your results or your experience in the first 30 days from your purchase simply let us know via the <a href="contact/" class="link">Contact Us</a> 
                        page and we'll give you a full refund minus shipping and handling within 48 hours of the product 
                        being returned. 
                    </p>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <div id="copyright" class="text-md"></div>
        <div class="footer-links text-sm">
            <a href="contact/" id="foot-link1">Contact Us</a> | <a href="terms/" id="foot-link2">Terms and Conditions</a> | <a href="privacy/" id="foot-link3">Privacy Policy</a>
        </div>
    </footer>

    <script>
    (async () => {
    // --- One source of truth for API globals ---
    window.CLIENT_ID = window.CLIENT_ID || 'd831c360-00e1-706a-6d3a-2a5361c20df6';
    // Keep the trailing slash:
    window.API_URL   = window.API_URL   || 'https://api-dev.juniorbay.com/';

    // Local aliases so old code using bare names keeps working
    const CLIENT_ID = window.CLIENT_ID;
    const API_URL   = window.API_URL;

    // Explicit endpoints for your POST flows (so we don't overload API_URL)
    API_URL_CHECKOUT        = `${API_URL}public/checkout-session`;  // creates Checkout Session
    API_URL_PAYMENT_INTENT  = `${API_URL}create-payment-intent`;    // PaymentIntent/card flow

    // Helpers
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const fmt = cents => (typeof cents === 'number') ? `$${(cents/100).toFixed(2)}` : 'â€”';

    // Decide which is regular vs discounted for a group of prices
    function resolveRegularDiscount(pricesForProduct) {
        // Only use active, non-recurring, with a unit_amount
        const active = pricesForProduct.filter(p =>
        p.active && p.unit_amount != null && (!p.recurring || p.recurring === null)
        );

        if (!active.length) return { regular: null, discounted: null };

        // Scoring to pick "discounted"
        const isDiscounted = p =>
        (p.metadata && p.metadata.is_default === "true") ||
        (p.metadata && (p.metadata.type === "discounted")) ||
        (typeof p.nickname === 'string' && /discount/i.test(p.nickname));

        // Scoring to pick "regular"
        const isRegular = p =>
        (p.metadata && p.metadata.is_default === "false") ||
        (p.metadata && (p.metadata.type === "regular")) ||
        (typeof p.nickname === 'string' && /regular/i.test(p.nickname));

        let discounted = active.find(isDiscounted);
        let regular = active.find(isRegular);

        // Fallbacks:
        if (!discounted || !regular) {
        // Sort by price to infer
        const byAmount = [...active].sort((a,b) => a.unit_amount - b.unit_amount);
        const lowest = byAmount[0];
        const highest = byAmount[byAmount.length - 1];

        if (!discounted) discounted = lowest;
        if (!regular) regular = highest;

        // If they are equal (only one price), treat as both
        if (regular && discounted && regular.id === discounted.id) {
            regular = discounted;
        }
        }

        // Final sanity: ensure regular is the higher or equal price
        if (regular && discounted && regular.unit_amount < discounted.unit_amount) {
        const tmp = regular;
        regular = discounted;
        discounted = tmp;
        }

        return { regular, discounted };
    }

    // Inject values into a given package card
    function populateCard(cardEl, group) {
        const regEl   = $('.txt-reg', cardEl);
        const priceEl = $('.txt-price', cardEl);
        const saveEl  = $('.txt-save', cardEl);
        const discEl  = $('.txt-discount', cardEl);
        const titleEl = $('h4', cardEl);

        const { product, regular, discounted } = group;

        // Product title
        if (titleEl && product?.name) titleEl.textContent = product.name;

        // Numbers
        const reg = regular?.unit_amount ?? null;
        const dis = discounted?.unit_amount ?? null;

        if (regEl)   regEl.textContent   = reg ? fmt(reg) : 'â€”';
        if (priceEl) priceEl.textContent = dis ? fmt(dis) : (reg ? fmt(reg) : 'â€”');

        if (saveEl) {
        const savings = (reg && dis && reg > dis) ? reg - dis : 0;
        saveEl.textContent = savings ? `You save ${fmt(savings)}` : '';
        }

        if (discEl) {
        if (reg && dis && reg > dis) {
            const pct = Math.round(((reg - dis) / reg) * 100);
            discEl.textContent = `${pct}% OFF`;
        } else {
            discEl.textContent = '';
        }
        }

        // Store data attrs for later (order summary, checkout, etc.)
        if (regular)     cardEl.dataset.regularAmount = String(regular.unit_amount);
        if (discounted)  cardEl.dataset.discountAmount = String(discounted.unit_amount);
        if (regular?.id) cardEl.dataset.regularPriceId = regular.id;
        if (discounted?.id) cardEl.dataset.discountPriceId = discounted.id;
        if (product?.id) cardEl.dataset.productId = product.id;
        if (product?.name) cardEl.dataset.productName = product.name;
    }

    // Update order summary when a card is selected
    function setOrderSummaryFromCard(cardEl) {
        const regCents = Number(cardEl.dataset.regularAmount || '0');
        const disCents = Number(cardEl.dataset.discountAmount || '0') || regCents;

        $('#os-regular').textContent = regCents ? fmt(regCents) : 'â€”';
        const discount = (regCents && disCents && regCents > disCents) ? (regCents - disCents) : 0;
        $('#os-discount').textContent = discount ? `- ${fmt(discount)}` : 'â€”';
        $('#os-final').textContent = fmt(disCents);
    }

    // Handle selecting cards
    function wireSelection(cards) {
        cards.forEach(card => {
        card.addEventListener('click', () => {
            cards.forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            setOrderSummaryFromCard(card);
        });
        });

        // Ensure default selected (whatever already has .selected)
        const current = cards.find(c => c.classList.contains('selected')) || cards[0];
        if (current) {
        current.classList.add('selected');
        setOrderSummaryFromCard(current);
        }
    }

    // Fetch & populate
    try {
        const res = await fetch(API, { headers: { 'Accept': 'application/json' }});
        if (!res.ok) throw new Error(`Bad response ${res.status}`);
        const data = await res.json();

        // Group by product.id
        const groups = new Map(); // productId -> { product, prices[] }
        (data.prices || []).forEach(p => {
        const pid = p?.product?.id;
        if (!pid) return;
        if (!groups.has(pid)) groups.set(pid, { product: p.product, prices: [] });
        groups.get(pid).prices.push(p);
        });

        // Find all package cards currently on the page (IDs are product IDs)
        const cards = $$('.package-card');
        cards.forEach(card => {
        const pid = card.id;
        const group = groups.get(pid);
        if (!group) return; // card not represented in current API payload
        const { regular, discounted } = resolveRegularDiscount(group.prices);
        populateCard(card, { product: group.product, regular, discounted });
        });

        wireSelection(cards);
    } catch (err) {
        console.error('Failed to populate package cards', err);
    }
    })();

        // --- Countdown Timer (unchanged) ---
        let timeLeft = 5 * 60;
        const productPrices = {};  
        const countdownElement = document.getElementById('countdown');
        let discountExpired = false;

        function updateCountdown() {
        if (timeLeft <= 0) {
            countdownElement.textContent = '00:00';

            if (!discountExpired) {
            discountExpired = true;

            document.querySelectorAll('.txt-reg').forEach(el => el.style.opacity = '0');
            document.querySelectorAll('.txt-save').forEach(el => el.textContent = '');
            document.querySelectorAll('.txt-discount').forEach(el => el.textContent = '');

            // Update each card with its regular price from Stripe
            document.querySelectorAll('.package-card').forEach(card => {
                const product_id = card.id;
                const pricing = productPrices[product_id];
                const regular = pricing?.regular;

                const priceEl = card.querySelector('.txt-price');
                if (priceEl && regular) {
                priceEl.textContent = formatCurrency(regular.unit_amount, regular.currency);
                }
            });

            updatePurchaseButton();
            renderOrderSummary();
            updateOrderSummary();
            }
            return;
        }

        const m = Math.floor(timeLeft / 60);
        const s = timeLeft % 60;
        countdownElement.textContent = `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
        timeLeft--;
        }
        setInterval(updateCountdown, 1000);


        let selectedPackage = document.querySelector('.package-card.selected')?.dataset.package || 'popular';
        const purchaseBtn    = document.getElementById('purchase-btn');
        const packageCards   = document.querySelectorAll('.package-card');

        function updatePurchaseButton() {
        const product_id = getSelectedProductId();
        const pricing = productPrices[product_id];
        if (!pricing) return; // not loaded yet

        const chosen = (timeLeft > 0 ? pricing.discounted : pricing.regular) || pricing.discounted;
        if (!chosen) return;

        const priceText = formatCurrency(chosen.unit_amount, chosen.currency);
        purchaseBtn.textContent = `Order Now - ${priceText} + FREE Shipping`;
        }


        // --- Icons (checked vs empty) ---
        const CHECKED_SVG = `
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="h-3 w-3">
        <circle cx="12" cy="12" r="12" fill="#3b84f6" />
        <path d="M20 6 9 17l-5-5" fill="none" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`;
        const EMPTY_SVG = `
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" class="h-3 w-3">
        <circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2" />
        </svg>`;
        function renderIcons() {
        document.querySelectorAll('.package-card').forEach(card => {
            const icon = card.querySelector('.icon-check');
            if (!icon) return;
            icon.innerHTML = card.classList.contains('selected') ? CHECKED_SVG : EMPTY_SVG;
        });
        }

        // --- Order Summary ---
        function moneyToNumber(text) {
        if (!text) return 0;
        // strips $, commas, spaces; keeps decimals
        return parseFloat(String(text).replace(/[^0-9.]/g, '')) || 0;
        }

        function getSelectedCard() {
        return document.querySelector('.package-card.selected');
        }

        function readPricesFromCard(card) {
        // Original price = crossed-out span, Discounted price = bold primary span
        const originalText  = card?.querySelector('.right .line-through')?.textContent || '';
        const discountedText = card?.querySelector('.right .text-primary')?.textContent || '';
        const nameText = card?.querySelector('.left h4')?.textContent?.trim() || '';
        const original = moneyToNumber(originalText);
        const price    = moneyToNumber(discountedText);
        const saved    = Math.max(original - price, 0);
        return { nameText, original, price, saved };
        }

        function renderOrderSummary() {
        const card = getSelectedCard();
        const { nameText, price, saved } = readPricesFromCard(card);

        const nameEl   = document.getElementById('os-package-name');
        const priceEl  = document.getElementById('os-price');
        const saveEl   = document.getElementById('os-savings');

        if (nameEl)  nameEl.textContent  = nameText || 'â€”';
        if (priceEl) priceEl.textContent = price ? `$${price.toFixed(2)}` : 'â€”';
        if (saveEl)  saveEl.textContent  = saved ? `$${saved.toFixed(2)}` : '$0.00';
        }

        function updateOrderSummary() {
        const selectedCard = document.querySelector('.package-card.selected');
        if (!selectedCard) return;

        const regText = selectedCard.querySelector('.right .txt-reg')?.textContent || '';
        const finalText = selectedCard.querySelector('.right .txt-price')?.textContent || '';

        const regPrice = parseFloat(regText.replace(/[^0-9.]/g, '')) || 0;
        const finalPrice = parseFloat(finalText.replace(/[^0-9.]/g, '')) || 0;
        const discount = regPrice && finalPrice ? regPrice - finalPrice : 0;

        // Update DOM
        document.getElementById('os-regular').textContent = regPrice ? `$${regPrice.toFixed(2)}` : 'â€”';
        document.getElementById('os-discount').textContent = discount ? `- $${discount.toFixed(2)}` : 'â€”';
        document.getElementById('os-final').textContent = finalPrice ? `$${finalPrice.toFixed(2)}` : 'â€”';

        // Tax is calculated by Stripe at checkout
        const taxEl = document.getElementById('os-tax');
        if (taxEl) taxEl.textContent = 'Tax will be settled at checkout';
        }

        // --- Stripe Init (same style as checkout.html) ---
        const stripe   = Stripe('pk_test_mTW79VPNrNQEECSvj5AdC66n00UjfFE9kO'); // publishable
        const elements = stripe.elements();
        const cardElement = elements.create('card', {
        style: { base: { fontSize: '16px', color: '#424770', '::placeholder': { color: '#aab7c4' } } }
        });
        cardElement.mount('#card-element');

        // --- Product/Price state ---
        let productData = null;   // { product, price, tax_amount, shipping_cost, total_amount }
        let activePriceId = null; // track which price ID is active

        function getSelectedProductId() {
        // Each card's id already equals the Stripe product id in your HTML
        const selectedCard = document.querySelector('.package-card.selected');
        return selectedCard ? selectedCard.id : 'prod_SxJgASmAPdNEgf';
        }

        // --- API helpers ---
        function formatCurrency(amount, currency = 'usd') {
        return new Intl.NumberFormat('en-US', { style: 'currency', currency: currency.toUpperCase() })
            .format(amount / 100);
        }

        async function preloadAllProductPrices() {
        const cards = document.querySelectorAll('.package-card');

        try {
            // Fetch all prices once from the public/prices endpoint
            const res = await fetch(`${API_URL}public/prices?clientID=${CLIENT_ID}`, {
                method: 'GET',
                headers: { 
                    'Content-Type': 'application/json'
                }
            });
            if (!res.ok) throw new Error('Failed to fetch product information');
            const data = await res.json();

            const allPrices = data.prices || [];

            // Group prices by product_id
            for (const card of cards) {
                const product_id = card.id;
                const productPrices_for_id = allPrices.filter(p => p.product.id === product_id);
                
                const discounted = productPrices_for_id.find(p => p.metadata.type === "discounted");
                const regular    = productPrices_for_id.find(p => p.metadata.type === "regular");

                productPrices[product_id] = { discounted, regular };
            }
        } catch (err) {
            console.error('Error loading prices:', err);
        }
        }

        async function loadProductInfo() {
        const product_id = getSelectedProductId();
        try {
            // Fetch all prices from the public/prices endpoint
            const res = await fetch(`${API_URL}public/prices?clientID=${CLIENT_ID}`, {
                method: 'GET',
                headers: { 
                    'Content-Type': 'application/json'
                }
            });

            if (!res.ok) throw new Error('Failed to fetch product information');
            const data = await res.json();
            if (data.error) throw new Error(data.error);

            // Filter prices for this specific product
            const allPrices = data.prices || [];
            const prices = allPrices.filter(p => p.product.id === product_id);
            
            // --- Find discounted/regular from Stripe metadata ---
            const discounted = prices.find(p => p?.metadata?.type === 'discounted') || null;
            const regular    = prices.find(p => p?.metadata?.type === 'regular')    || null;

            if (!discounted && !regular && prices.length === 0) {
            throw new Error('No matching price found');
            }

            // Cache them for this product (your existing structure)
            productPrices[product_id] = { discounted, regular, all: prices };

            // Get product info from the first price's product object
            const productInfo = prices.length > 0 ? prices[0].product : null;
            if (!productInfo) {
                throw new Error('Product information not found');
            }

            // Helper: choose which price should be active *right now*
            const pickActivePrice = () => {
            // if countdown still running and we have discounted, use it
            if (timeLeft > 0 && discounted) return discounted;
            // otherwise prefer regular, fall back to discounted, then any price
            return regular || discounted || prices[0] || null;
            };

            // Build productData fresh
            const baseProductData = {
            product: productInfo,
            prices: prices
            // we will add a dynamic getter for .price below
            };

            // Make productData.price a dynamic getter that always picks based on current timer
            productData = baseProductData;
            Object.defineProperty(productData, 'price', {
            get() { return pickActivePrice(); },
            enumerable: true
            });

            // --- Update UI using the *current* active price ---
            const chosenPrice = pickActivePrice();
            if (!chosenPrice) throw new Error('No matching price found');

            const priceText = formatCurrency(chosenPrice.unit_amount, chosenPrice.currency);
            purchaseBtn.textContent = `Order Now - ${priceText} + FREE Shipping`;

            // Order summary: prefer regular for "compare at", fallback gracefully
            const regAmt   = (regular?.unit_amount) ?? chosenPrice.unit_amount;
            const finalAmt = chosenPrice.unit_amount;
            const discount = regAmt - finalAmt;

            document.getElementById('os-regular').textContent  = regAmt ? formatCurrency(regAmt, chosenPrice.currency) : 'â€”';
            document.getElementById('os-final').textContent    = finalAmt ? formatCurrency(finalAmt, chosenPrice.currency) : 'â€”';
            document.getElementById('os-discount').textContent = discount > 0 ? `- ${formatCurrency(discount, chosenPrice.currency)}` : 'â€”';
            document.getElementById('os-tax').textContent      = 'Tax will be settled at checkout';

            // (Optional) expose active id if you want to debug elsewhere
            window.activePriceId = chosenPrice.id;

        } catch (err) {
            console.error(err);
            showError('Unable to load product info.');
        }
        }


        function showError(msg) {
        const el = document.getElementById('error-message');
        el.textContent = msg;
        el.style.display = 'block';
        }
        function hideError() {
        const el = document.getElementById('error-message');
        el.style.display = 'none';
        }

        function showCopyright() {
        const el = document.getElementById('copyright');
        const yyyy = new Date().getFullYear();
        let msg = `\u00A9 ${yyyy} Junior Bay Corporation - All rights reserved.`;
        el.textContent = msg
        }

        function updateLinkText() {
            const mq = window.matchMedia("(max-width: 359px)");

            const link1 = document.getElementById("foot-link1");
            const link2 = document.getElementById("foot-link2");
            const link3 = document.getElementById("foot-link3");

            if (!link1 || !link2 || !link3) return; // safety check

            if (mq.matches) {
            // Small mobile screens
            link1.innerHTML = "Contact";
            link2.innerHTML = "Terms";
            link3.innerHTML = "Privacy";
            } else {
            // Default text for larger screens
            link1.innerHTML = "Contact Us";
            link2.innerHTML = "Terms and Conditions";
            link3.innerHTML = "Privacy Policy";
            }
        }

        window.addEventListener("resize", updateLinkText);

        // --- Helper function to determine if upsell should be shown ---
        function shouldShowUpsell(productId) {
        // Show upsell only for the basic package (1 item)
        return productId === 'prod_SxJKn7l9FUAD0B';
        }

        // --- Click handlers for package cards ---
        packageCards.forEach(card => {
        card.addEventListener('click', async function () {
            packageCards.forEach(c => c.classList.remove('selected'));
            this.classList.add('selected');
            selectedPackage = this.dataset.package;
            renderIcons();
            updatePurchaseButton();
            renderOrderSummary();
            updateOrderSummary();
            // Load the newly selected product's info (updates pricing)
            await loadProductInfo();
        });
        });

        // --- Purchase button scroll (keep your UX) ---
        purchaseBtn.addEventListener('click', async () => {
            try {
                const product_id = getSelectedProductId();
                if (!productData) {
                    console.warn("Product data missing, retrying load for:", selectedPackage);
                    await loadProductInfo(); // fallback load if not ready
                }

                if (!productData || !productData.price) {
                    throw new Error("Price not loaded. Please try again.");
                }

                const price_id = productData.price.id;

                if (!price_id) throw new Error("Price not loaded. Please try again.");

                const res = await fetch(API_URL_CHECKOUT, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'X-Client-Id': CLIENT_ID,
                        'X-Offer-Name': 'NAD Supplement'
                    },
                    body: JSON.stringify({
                        action: 'create_checkout_session', // keep if your backend expects it
                        product_id,
                        price_id,
                        offer_name: 'NAD Supplement'
                    })
                });


                const data = await res.json();
                if (!data.id) {
                    throw new Error(data.error || 'Failed to create checkout session');
                }

                // Redirect to Stripe Checkout
                const { error } = await stripe.redirectToCheckout({ sessionId: data.id });
                if (error) {
                    console.error('Stripe Checkout redirect error:', error.message);
                    showError(error.message);
                }
            } catch (err) {
                console.error('Error starting checkout:', err);
                showError('Unable to start checkout. Please try again.');
            }
        });


        // --- Same-as-billing toggle + live sync + show/hide shipping section ---
        const sameAsBillingCheckbox = document.getElementById('same-as-billing');
        const SHIP_SECTION = document.getElementById('shipping-section');

        function syncShippingFields(checked) {
        const map = { address: 'shipping-address', address2: 'shipping-address2', city: 'shipping-city', state: 'shipping-state', zip: 'shipping-zip' };
        Object.entries(map).forEach(([bill, ship]) => {
            const b = document.getElementById(bill), s = document.getElementById(ship);
            if (!b || !s) return;
            if (checked) {
            s.value = b.value;
            s.disabled = true;
            s.style.backgroundColor = '#f8f9fa';
            } else {
            s.disabled = false;
            s.style.backgroundColor = 'white';
            }
        });
        }

        function toggleShippingSection() {
        if (!SHIP_SECTION) return;
        SHIP_SECTION.style.display = sameAsBillingCheckbox.checked ? 'none' : 'block';
        }

        sameAsBillingCheckbox.addEventListener('change', () => {
        toggleShippingSection();
        syncShippingFields(sameAsBillingCheckbox.checked);
        });

        // Keep live sync while checked
        ['address','address2','city','state','zip'].forEach(id => {
        const el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('input', function() {
            if (!sameAsBillingCheckbox.checked) return;
            const map = { address: 'shipping-address', address2: 'shipping-address2', city: 'shipping-city', state: 'shipping-state', zip: 'shipping-zip' };
            const target = document.getElementById(map[id]);
            if (target) target.value = this.value;
        });
        });

        // --- Helper function to get the correct shipping address ---
        function getShippingAddress() {
        // If "same as billing" is checked, use billing address
        if (sameAsBillingCheckbox.checked) {
            return {
            line1: document.getElementById('address').value,
            line2: document.getElementById('address2').value || undefined,
            city: document.getElementById('city').value,
            state: document.getElementById('state').value,
            postal_code: document.getElementById('zip').value,
            country: 'US'
            };
        } else {
            // Use the shipping form fields
            return {
            line1: document.getElementById('shipping-address').value,
            line2: document.getElementById('shipping-address2').value || undefined,
            city: document.getElementById('shipping-city').value,
            state: document.getElementById('shipping-state').value,
            postal_code: document.getElementById('shipping-zip').value,
            country: 'US'
            };
        }
        }

        // --- Form submit: create PaymentIntent then confirm with Stripe ---
        const form = document.getElementById('payment-form');
        const submitButton = document.getElementById('submit-button');
        const successMessage = document.getElementById('success-message');

        form.addEventListener('submit', async (e) => {
        e.preventDefault();
        hideError();
        successMessage.style.display = 'none';

        if (!productData) {
            showError('Product information not loaded. Please try again.');
            return;
        }

        submitButton.disabled = true;
        submitButton.textContent = 'Processing...';

        const name  = `${document.getElementById('firstName').value} ${document.getElementById('lastName').value}`.trim();
        const email = document.getElementById('email').value;
        const phone = document.getElementById('phone').value;

        const billing_address = {
            line1: document.getElementById('address').value,
            line2: document.getElementById('address2').value || undefined,
            city:  document.getElementById('city').value,
            state: document.getElementById('state').value,
            postal_code: document.getElementById('zip').value,
            country: 'US'
        };

        // Use the helper function to get the correct shipping address
        const shipping_address = getShippingAddress();

        console.log('Shipping address being sent to Stripe:', shipping_address); // Debug log

        try {
            // 1) Create PaymentIntent on your server (Lambda @ /create-payment-intent)
            const response = await fetch(API_URL_PAYMENT_INTENT, {
            method: 'POST',
            headers: { 
                'Content-Type': 'application/json',
                'X-Client-Id': CLIENT_ID  // Add the client ID header
            },
            body: JSON.stringify({
                amount:       productData.total_amount,
                currency:     productData.price.currency,
                product_id:   productData.product.id,
                customer_info: { 
                email, 
                name, 
                phone,
                billing_address, 
                shipping_address 
                }
            })
            });
            const result = await response.json();
            if (!response.ok) throw new Error(result.error || 'Failed to create payment intent');

            // 2) Confirm with Stripe.js - make sure shipping address is properly formatted
            const confirmParams = {
            payment_method: {
                card: cardElement,
                billing_details: { 
                name, 
                email, 
                phone,
                address: billing_address 
                }
            }
            };

            // Only add shipping if we have a valid address
            if (shipping_address.line1 && shipping_address.city && shipping_address.state && shipping_address.postal_code) {
            confirmParams.shipping = {
                name: name,
                phone: phone,
                address: shipping_address
            };
            console.log('Adding shipping to confirmParams:', confirmParams.shipping); // Debug log
            } else {
            console.log('Shipping address incomplete, not adding to confirmParams'); // Debug log
            }

            const { error, paymentIntent } = await stripe.confirmCardPayment(result.client_secret, confirmParams);

            if (error) {
            showError(error.message);
            } else if (paymentIntent && paymentIntent.status === 'succeeded') {
            console.log('Payment succeeded! PaymentIntent:', paymentIntent); // Debug log
            
            // Store order data for potential upsell
            const orderData = {
                paymentIntentId: paymentIntent.id,
                customerId: result.customer_id,
                customerName: name,
                customerEmail: email,
                customerPhone: phone,
                productId: productData.product.id,
                amount: productData.total_amount,
                shippingAddress: shipping_address,  // add
                billingAddress: billing_address     // add
            };

            // Check if upsell should be shown
            if (shouldShowUpsell(productData.product.id)) {
                // Store original order data in session storage
                sessionStorage.setItem('originalOrder', JSON.stringify(orderData));
                
                // Redirect to upsell page
                window.location.href = 'upsell.html';
            } else {
                // Redirect to thank you page for multi-item orders
                window.location.href = 'thank-you.html';
            }
            } else {
            showError('Payment was not completed. Please try again.');
            }
        } catch (err) {
            console.error(err);
            showError(err.message || 'An error occurred. Please try again.');
        }

        submitButton.disabled = false;
        submitButton.textContent = 'Complete Order';
        });

        // --- Init once DOM is ready ---
        document.addEventListener('DOMContentLoaded', async () => {
        showCopyright();
        renderIcons();

        await preloadAllProductPrices();

        // Force-load default selected card
        selectedPackage = document.querySelector('.package-card.selected')?.dataset.package || 'popular';
        await loadProductInfo();

        if (!productData) {
            console.error("Failed to load default product info for:", selectedPackage);
        }

        updatePurchaseButton();
        renderOrderSummary();
        updateOrderSummary();
        updateLinkText();

        if (sameAsBillingCheckbox) {
            sameAsBillingCheckbox.checked = true;
            toggleShippingSection();
            syncShippingFields(true);
        }
        });
    </script>

<!-- ===== PATCH: Stripe prices population + API globals (non-destructive) ===== -->
<script>
(function() {
  // --- Globals: keep trailing slash on API_URL ---
  if (!('CLIENT_ID' in window)) window.CLIENT_ID = 'd831c360-00e1-706a-6d3a-2a5361c20df6';
  if (!('API_URL'   in window)) window.API_URL   = 'https://api-dev.juniorbay.com/';
  if (!window.API_URL.endsWith('/')) window.API_URL += '/';

  if (!('API_URL_CHECKOUT' in window))       window.API_URL_CHECKOUT       = `${window.API_URL}public/checkout-session`;
  if (!('API_URL_PAYMENT_INTENT' in window)) window.API_URL_PAYMENT_INTENT = `${window.API_URL}create-payment-intent`;

  // Local aliases so existing bare-name calls like `${API_URL}public/prices?...` work
  const CLIENT_ID = window.CLIENT_ID;
  const API_URL   = window.API_URL;

  // Shared caches (non-destructive; reuse if already present)
  if (!('productPrices' in window)) window.productPrices = {};
  if (!('allPricesCache' in window)) window.allPricesCache = null;

  // Helper: decide regular vs discounted
  if (typeof window.resolveRegularDiscount !== 'function') {
    window.resolveRegularDiscount = function resolveRegularDiscount(pricesForProduct) {
      const active = (pricesForProduct || []).filter(p =>
        p && p.active && p.unit_amount != null && (!p.recurring || p.recurring === null)
      );
      if (!active.length) return { regular: null, discounted: null };

      const isDiscounted = p =>
        (p?.metadata?.is_default === "true") ||
        (p?.metadata?.type === "discounted") ||
        ((typeof p?.nickname === 'string') && /discount/i.test(p.nickname));

      const isRegular = p =>
        (p?.metadata?.is_default === "false") ||
        (p?.metadata?.type === "regular") ||
        ((typeof p?.nickname === 'string') && /regular/i.test(p.nickname));

      let discounted = active.find(isDiscounted);
      let regular    = active.find(isRegular);

      // Fallback to price inference
      if (!discounted || !regular) {
        const byAmount = [...active].sort((a,b) => a.unit_amount - b.unit_amount);
        discounted = discounted || byAmount[0];
        regular    = regular    || byAmount[byAmount.length - 1];
        if (regular && discounted && regular.id === discounted.id) regular = discounted;
      }
      if (regular && discounted && regular.unit_amount < discounted.unit_amount) {
        const t = regular; regular = discounted; discounted = t;
      }
      return { regular, discounted };
    };
  }

  // Fetch all prices once
  async function fetchAllPricesOnce() {
    if (window.allPricesCache) return window.allPricesCache;
    const url = `${API_URL}public/prices?clientID=${encodeURIComponent(CLIENT_ID)}`;
    const res = await fetch(url, { method: 'GET', headers: { 'Accept': 'application/json' }});
    if (!res.ok) throw new Error(`Failed to fetch prices: ${res.status}`);
    window.allPricesCache = await res.json();
    return window.allPricesCache;
  }

  // Override/define preload (idempotent)
  window.preloadAllProductPrices = async function preloadAllProductPrices() {
    const cards = document.querySelectorAll('.package-card');
    try {
      const data = await fetchAllPricesOnce();
      const all = data?.prices || [];

      for (const card of cards) {
        const pid = card.id;
        const pricesForProduct = all.filter(p => p?.product?.id === pid);
        const { regular, discounted } = window.resolveRegularDiscount(pricesForProduct);
        window.productPrices[pid] = { regular, discounted, all: pricesForProduct };
      }
    } catch (err) {
      console.error('Error loading prices:', err);
    }
  };

  // Populate visible cards from cache (does not change your layout/DOM structure)
  window.populatePackageCardsFromCache = function populatePackageCardsFromCache() {
    const cards = document.querySelectorAll('.package-card');
    for (const card of cards) {
      const entry = window.productPrices[card.id];
      if (!entry) continue;

      const { regular, discounted, all } = entry;
      const title = all?.[0]?.product?.name;

      const regEl   = card.querySelector('.txt-reg');
      const priceEl = card.querySelector('.txt-price');
      const saveEl  = card.querySelector('.txt-save');
      const discEl  = card.querySelector('.txt-discount');
      const titleEl = card.querySelector('h4');

      if (titleEl && title) titleEl.textContent = title;

      const regCents  = regular?.unit_amount ?? null;
      const discCents = discounted?.unit_amount ?? null;
      const fmt = x => (typeof x === 'number') ? `$${(x/100).toFixed(2)}` : 'â€”';

      if (regEl)   regEl.textContent   = (regCents != null)  ? fmt(regCents) : 'â€”';
      if (priceEl) priceEl.textContent = (discCents != null) ? fmt(discCents) : (regEl?.textContent || 'â€”');

      if (regCents != null && discCents != null && regCents > discCents) {
        const pct = Math.round(((regCents - discCents) / regCents) * 100);
        if (saveEl) saveEl.textContent = `You save ${fmt(regCents - discCents)}`;
        if (discEl) discEl.textContent = `${pct}% OFF`;
      } else {
        if (saveEl) saveEl.textContent = '';
        if (discEl) discEl.textContent = '';
      }

      // Useful data attrs for your other handlers
      if (regular) {
        card.dataset.regularAmount = String(regular.unit_amount);
        card.dataset.regularPriceId = regular.id;
      }
      if (discounted) {
        card.dataset.discountAmount = String(discounted.unit_amount);
        card.dataset.discountPriceId = discounted.id;
      }
    }
  };

  // Override/define loadProductInfo that honors your timer (timeLeft)
  window.loadProductInfo = async function loadProductInfo() {
    const selected = document.querySelector('.package-card.selected') || document.querySelector('.package-card');
    const product_id = selected?.id;
    if (!product_id) return;

    try {
      const data = await fetchAllPricesOnce();
      const all = data?.prices || [];
      const prices = all.filter(p => p?.product?.id === product_id);
      const { regular, discounted } = window.resolveRegularDiscount(prices);

      const product = prices[0]?.product || null;
      if (!product) throw new Error('Product info not found');

      const nowTimeLeft = (typeof window.timeLeft === 'number') ? window.timeLeft : 0;
      const chosen = (nowTimeLeft > 0 && discounted) ? discounted : (regular || discounted || prices[0]);

      // Minimal state expected by your existing code:
      window.productData = {
        product_id: product.id,
        product,
        price: chosen,
        tax_amount: 0,
        shipping_cost: 0,
        total_amount: chosen?.unit_amount ?? null
      };
      window.activePriceId = chosen?.id || null;
    } catch (e) {
      console.error('loadProductInfo failed:', e);
    }
  };

  // Boot this patch AFTER your pageâ€™s own listeners have run
  window.addEventListener('DOMContentLoaded', async () => {
    try {
      await window.preloadAllProductPrices();
      window.populatePackageCardsFromCache();
      await window.loadProductInfo();
    } catch (e) {
      console.warn('Patch init failed:', e);
    }
  });
})();
</script>
<!-- ===== /PATCH ===== -->


<!-- ===== PATCH: switch to regular price when countdown hits zero (non-destructive) ===== -->
<script>
(function() {
  // Guard against double install
  if (window.__regularPriceExpiryPatchInstalled) return;
  window.__regularPriceExpiryPatchInstalled = true;

  function fmtUSD(cents) {
    return (typeof cents === 'number') ? `$${(cents/100).toFixed(2)}` : 'â€”';
  }

  function applyRegularPricing() {
    // Prevent repeated work
    if (window.__regularAppliedOnce) return;
    window.__regularAppliedOnce = true;

    const cards = document.querySelectorAll('.package-card');
    cards.forEach(card => {
      // prefer explicit dataset regular; fall back to cache if available
      let regCents = card.dataset.regularAmount ? Number(card.dataset.regularAmount) : null;
      if (regCents == null && window.productPrices && window.productPrices[card.id]?.regular?.unit_amount != null) {
        regCents = window.productPrices[card.id].regular.unit_amount;
      }
      if (regCents == null) return; // nothing to do

      const priceEl = card.querySelector('.txt-price');
      if (priceEl) priceEl.textContent = fmtUSD(regCents);

      // Also make sure the selected card updates summary + checkout mapping
      if (card.classList.contains('selected')) {
        // Prefer dataset's regular priceId if present
        const regularPriceId = card.dataset.regularPriceId
          || (window.productPrices && window.productPrices[card.id]?.regular?.id) || null;

        // Update global productData / activePriceId if they exist
        if (window.productData && window.productData.product_id === card.id) {
          window.productData.price = window.productPrices?.[card.id]?.regular || window.productData.price;
          window.productData.total_amount = regCents;
        }
        if (regularPriceId) window.activePriceId = regularPriceId;

        // Update order summary UI if helper exists, else do a minimal update
        if (typeof window.setOrderSummaryFrom === 'function') {
          window.setOrderSummaryFrom(card);
        } else {
          const osFinal = document.getElementById('os-final');
          if (osFinal) osFinal.textContent = fmtUSD(regCents);
        }
      }
    });
  }

  // Hook 1: poll the global timeLeft if present; run once at expiry
  function installTimeLeftWatcher() {
    if (window.__timeLeftWatcherInstalled) return;
    window.__timeLeftWatcherInstalled = true;

    let applied = false;
    setInterval(() => {
      // If the page defines timeLeft (seconds remaining), obey it; otherwise do nothing
      if (typeof window.timeLeft === 'number' && window.timeLeft <= 0 && !applied) {
        applied = true;
        applyRegularPricing();
      }
    }, 500);
  }

  // Hook 2 (fallback): watch the #countdown DOM for "00:00"
  function installCountdownObserver() {
    const node = document.getElementById('countdown');
    if (!node || window.__countdownObserverInstalled) return;
    window.__countdownObserverInstalled = true;

    const obs = new MutationObserver(() => {
      const txt = (node.textContent || '').trim();
      // Very defensive: treat "00:00" or "0:00" as expired
      if (/^0?0:0?0$/.test(txt)) {
        applyRegularPricing();
      }
    });
    obs.observe(node, { childList: true, characterData: true, subtree: true });
  }

  window.addEventListener('DOMContentLoaded', () => {
    installTimeLeftWatcher();
    installCountdownObserver();
  });

  // Also expose a manual hook if your timer wants to call it directly
  window.applyRegularPricingOnce = applyRegularPricing;
})();
</script>
<!-- ===== /PATCH ===== -->


<!-- ===== PATCH: robust productId/priceId resolution for checkout (non-destructive) ===== -->
<script>
(function() {
  if (window.__priceResolutionPatchInstalled) return;
  window.__priceResolutionPatchInstalled = true;

  // Helper: find the selected card
  function getSelectedCard() {
    return document.querySelector('.package-card.selected') || document.querySelector('.package-card');
  }

  // Ensure our populate step writes dataset.productId/productName too
  const originalPopulate = window.populatePackageCardsFromCache;
  window.populatePackageCardsFromCache = function patchedPopulatePackageCardsFromCache() {
    if (typeof originalPopulate === 'function') originalPopulate();

    // After original population, add dataset fields if missing
    const cards = document.querySelectorAll('.package-card');
    for (const card of cards) {
      const entry = window.productPrices?.[card.id];
      const first = entry?.all?.[0];
      const product = first?.product;
      if (product && !card.dataset.productId) {
        card.dataset.productId = product.id;
        card.dataset.productName = product.name || '';
      }
    }
  };

  // Derive the best priceId at the moment of clicking order
  window.getSelectedPriceId = function getSelectedPriceId() {
    const card = getSelectedCard();
    if (!card) return null;

    // Use timer to prefer discount while active
    const tl = (typeof window.timeLeft === 'number') ? window.timeLeft : 0;
    const preferDiscount = tl > 0;

    // Try datasets first
    const discountId = card.dataset.discountPriceId || null;
    const regularId  = card.dataset.regularPriceId  || null;
    if (preferDiscount && discountId) return discountId;
    if (regularId) return regularId;
    if (discountId) return discountId;

    // Fallback to cache
    const pid = card.dataset.productId || card.id;
    const entry = window.productPrices?.[pid] || window.productPrices?.[card.id];
    if (entry) {
      if (preferDiscount && entry.discounted?.id) return entry.discounted.id;
      return entry.regular?.id || entry.discounted?.id || null;
    }
    return null;
  };

  // Patch loadProductInfo to use dataset.productId if the element id is an alias (e.g., "popular")
  const originalLoad = window.loadProductInfo;
  window.loadProductInfo = async function patchedLoadProductInfo() {
    const card = getSelectedCard();
    if (!card) return (typeof originalLoad === 'function') ? originalLoad() : void 0;

    // Prefer dataset.productId written by the population step
    const product_id = card.dataset.productId || card.id;

    // If our cached prices are present, synthesize productData immediately
    const entry = window.productPrices?.[product_id] || window.productPrices?.[card.id];
    if (entry) {
      const tl = (typeof window.timeLeft === 'number') ? window.timeLeft : 0;
      const chosen = (tl > 0 && entry.discounted) ? entry.discounted : (entry.regular || entry.discounted);
      if (chosen) {
        window.productData = {
          product_id: product_id,
          product: entry.all?.[0]?.product || null,
          price: chosen,
          tax_amount: 0,
          shipping_cost: 0,
          total_amount: chosen.unit_amount ?? null
        };
        window.activePriceId = chosen.id;
        return;
      }
    }
    // Otherwise fall back to the original async loader (which will use our fetch cache)
    if (typeof originalLoad === 'function') {
      return originalLoad();
    }
  };

  // Safety net: intercept order button click to ensure a priceId exists
  function installOrderClickGuard() {
    const btn = document.getElementById('purchase-btn') || document.getElementById('orderBtn');
    if (!btn || btn.__orderGuardInstalled) return;
    btn.__orderGuardInstalled = true;

    btn.addEventListener('click', async (evt) => {
      // If a price is already set, let your existing handler run
      const hasPrice = !!(window.productData?.price?.id || window.activePriceId || window.getSelectedPriceId());
      if (hasPrice) return;

      // Otherwise, pre-resolve now so the existing handler sees state
      evt.stopPropagation();
      evt.preventDefault();
      try {
        await (window.preloadAllProductPrices?.() || Promise.resolve());
        await (window.loadProductInfo?.() || Promise.resolve());

        const priceId = window.productData?.price?.id || window.activePriceId || window.getSelectedPriceId();
        if (!priceId) throw new Error('Price not loaded. Please try again.');

        // Re-dispatch a click so your original listener proceeds with fresh state
        setTimeout(() => btn.click(), 0);
      } catch (e) {
        console.error(e);
        alert(e.message || String(e));
      }
    }, true); // capture to run before your original listener
  }

  window.addEventListener('DOMContentLoaded', () => {
    installOrderClickGuard();
  });
})();
</script>
<!-- ===== /PATCH ===== -->


<!-- ===== PATCH: Auto-map dummy .package-card ids to Stripe product.id (non-destructive) ===== -->
<script>
(function() {
  if (window.__autoMapDummyIdsPatchInstalled) return;
  window.__autoMapDummyIdsPatchInstalled = true;

  function norm(s) {
    return (s || '').toLowerCase().replace(/[^a-z0-9]+/g, ' ').trim();
  }
  function scoreNameMatch(cardText, productName) {
    const a = norm(cardText).split(/\s+/).filter(Boolean);
    const b = new Set(norm(productName).split(/\s+/).filter(Boolean));
    let score = 0;
    for (const w of a) if (b.has(w)) score += 1;
    return score;
  }

  function buildProductsIndex(allPrices) {
    const map = new Map();
    (allPrices || []).forEach(p => {
      const prod = p?.product;
      if (prod && prod.id && !map.has(prod.id)) map.set(prod.id, prod);
    });
    return map;
  }

  function selectProductForCard(card, products) {
    if (card.dataset.productId && products.has(card.dataset.productId)) {
      return products.get(card.dataset.productId);
    }
    const hint = (card.dataset.package || '').toLowerCase();
    if (hint) {
      if (hint === 'basic') {
        for (const prod of products.values()) {
          if (prod?.metadata?.product_category === 'basic') return prod;
        }
      }
      if (/(one|single)/.test(hint)) {
        for (const prod of products.values()) if (/one/i.test(prod?.name || '')) return prod;
      }
      if (/two/.test(hint))   { for (const prod of products.values()) if (/two/i.test(prod?.name || ''))   return prod; }
      if (/three/.test(hint)) { for (const prod of products.values()) if (/three/i.test(prod?.name || '')) return prod; }
      if (/nad/.test(hint))   { for (const prod of products.values()) if (/nad/i.test(prod?.name || ''))   return prod; }
    }

    const textBits = [
      card.querySelector('.pill')?.textContent,
      card.querySelector('h4')?.textContent,
      card.textContent
    ].filter(Boolean).join(' ');

    let best = null;
    let bestScore = -1;
    for (const prod of products.values()) {
      const s = scoreNameMatch(textBits, prod?.name || '');
      if (s > bestScore) { best = prod; bestScore = s; }
    }
    if (best) return best;
    return products.values().next().value || null;
  }

  const __origPreload = window.preloadAllProductPrices;
  window.preloadAllProductPrices = async function patchedPreloadAllProductPrices() {
    if (typeof __origPreload === 'function') {
      await __origPreload();
    } else {
      if (typeof window.allPricesCache === 'undefined' || window.allPricesCache === null) {
        if (typeof fetch !== 'undefined' && window.API_URL && window.CLIENT_ID) {
          const res = await fetch(`${window.API_URL}public/prices?clientID=${encodeURIComponent(window.CLIENT_ID)}`);
          if (res.ok) window.allPricesCache = await res.json();
        }
      }
    }

    const allPrices = (window.allPricesCache && window.allPricesCache.prices) || [];
    const products = buildProductsIndex(allPrices);
    const cards = document.querySelectorAll('.package-card');

    cards.forEach(card => {
      const prod = selectProductForCard(card, products);
      if (!prod) return;

      if (!card.dataset.originalId) card.dataset.originalId = card.id;
      card.dataset.productId = prod.id;
      if (prod.name) card.dataset.productName = prod.name;

      if (card.id !== prod.id) {
        if (!document.getElementById(prod.id)) {
          card.id = prod.id;
        } else {
          let i = 2, candidate = `${prod.id}-${i}`;
          while (document.getElementById(candidate)) { i += 1; candidate = `${prod.id}-${i}`; }
          card.id = candidate;
        }
      }
    });

    if (typeof window.populatePackageCardsFromCache === 'function') {
      window.populatePackageCardsFromCache();
    }
  };

  function removeBadges() {
    document.querySelectorAll('.package-badge').forEach(el => el.remove());
  }
  if (typeof window.applyRegularPricingOnce === 'function') {
    const __origApply = window.applyRegularPricingOnce;
    window.applyRegularPricingOnce = function patchedApplyRegularPricingOnce() {
      __origApply();
      removeBadges();
    };
  } else {
    const node = document.getElementById('countdown');
    if (node) {
      const obs = new MutationObserver(() => {
        const txt = (node.textContent || '').trim();
        if (/^0?0:0?0$/.test(txt)) removeBadges();
      });
      obs.observe(node, { childList: true, characterData: true, subtree: true });
    }
  }
})();
</script>
<!-- ===== /PATCH ===== -->

<!-- ===== PATCH: Filter to only products where name starts with 'NAD Supplement - ' (non-destructive) ===== -->
<script>
(function() {
  if (window.__filterNadSupplementPatchInstalled) return;
  window.__filterNadSupplementPatchInstalled = true;

  function filterToNad(cache) {
    try {
      if (!cache || !Array.isArray(cache.prices)) return cache;
      cache.prices = cache.prices.filter(p => {
        const name = p && p.product && p.product.name ? String(p.product.name) : '';
        return /^\s*NAD\s+Supplement\s*-\s/i.test(name);
      });
    } catch (e) {
      console.warn('NAD filter failed:', e);
    }
    return cache;
  }

  // Patch fetchAllPricesOnce (if present) to filter after fetch
  if (typeof window.fetchAllPricesOnce === 'function') {
    const __origFetchOnce = window.fetchAllPricesOnce;
    window.fetchAllPricesOnce = async function patchedFetchAllPricesOnce() {
      const data = await __origFetchOnce();
      return filterToNad(data);
    };
  }

  // If cache already exists, filter it immediately
  if (window.allPricesCache) {
    filterToNad(window.allPricesCache);
  }

  // Also, patch preloadAllProductPrices to ensure we filter before use
  if (typeof window.preloadAllProductPrices === 'function') {
    const __origPreload = window.preloadAllProductPrices;
    window.preloadAllProductPrices = async function patchedPreload() {
      if (window.allPricesCache) filterToNad(window.allPricesCache);
      const res = await __origPreload();
      if (window.allPricesCache) filterToNad(window.allPricesCache);
      return res;
    };
  }
})();
</script>
<!-- ===== /PATCH ===== -->

<!-- PATCH: Build package cards from API (NAD only) + badges + toggle check icon + checkout guard -->
<script>
(function () {
  if (window.__buildCardsFromAPI_v2) return;
  window.__buildCardsFromAPI_v2 = true;

  // ---- Config fallback ----
  window.CLIENT_ID = window.CLIENT_ID || 'd831c360-00e1-706a-6d3a-2a5361c20df6';
  window.API_URL   = window.API_URL   || 'https://api-dev.juniorbay.com/';
  if (!window.API_URL.endsWith('/')) window.API_URL += '/';

  // ---- Helpers ----
  const $  = (s, r=document)=>r.querySelector(s);
  const $$ = (s, r=document)=>Array.from(r.querySelectorAll(s));
  const fmt = cents => (typeof cents === 'number') ? `$${(cents/100).toFixed(2)}` : 'â€”';

  const uncheckedIcon = () => `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
         viewBox="0 0 24 24" class="h-3 w-3">
      <circle cx="12" cy="12" r="11" fill="none" stroke="#64758b" stroke-width="2"></circle>
    </svg>
  `.trim();

  const checkedIcon = () => `
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
         viewBox="0 0 24 24" class="h-3 w-3">
      <circle cx="12" cy="12" r="11" fill="none" stroke="#0ea5e9" stroke-width="2"></circle>
      <path d="M7 12l3 3 7-7" fill="none" stroke="#0ea5e9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
  `.trim();

  // Star badge SVG used for Popular/Best Value
  const starIcon = `
    <svg xmlns="http://www.w3.org/2000/svg" class="icon-pop" viewBox="0 0 20 20" fill="currentColor">
      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
    </svg>
  `.trim();

  // Always fresh fetch
  async function fetchPrices() {
    const url = `${window.API_URL}public/prices?clientID=${encodeURIComponent(window.CLIENT_ID)}&ts=${Date.now()}`;
    const res = await fetch(url, { cache: 'no-store', headers: { 'Accept': 'application/json' } });
    if (!res.ok) throw new Error('Failed to fetch prices');
    return res.json();
  }

  // Only NAD Supplement - ...; EXCLUDE upsell/offer product (e.g., "(18% Discount)")
//   function filterNAD(data) {
//     const re = /^\s*NAD\s+Supplement\s*-\s/i;
//     const exclude = /\(18%\s*Discount\)/i;
//     return (data?.prices || []).filter(p => {
//       const name = p?.product?.name || '';
//       return re.test(name) && !exclude.test(name);
//     });
//   }

  function filterNAD(data) {
    const out = { clientID: data?.clientID || null, prices: [] };
    const re = /^\s*NAD\s+Supplement\s*-\s/i;
    out.prices = (data?.prices || []).filter(p => re.test(p?.product?.name || ''));
    return out;
  }

  function byProduct(prices) {
    const m = new Map();
    for (const p of prices) {
      const pid = p?.product?.id; if (!pid) continue;
      if (!m.has(pid)) m.set(pid, []);
      m.get(pid).push(p);
    }
    return m;
  }

  function resolveRegularDiscount(list) {
    const active = (list || []).filter(p => p.active && p.unit_amount != null && (!p.recurring || p.recurring === null));
    if (!active.length) return { regular: null, discounted: null };
    const isDisc = p => (p?.metadata?.is_default === "true") || /discount/i.test(p?.nickname||'') || p?.metadata?.type === 'discounted';
    const isReg  = p => (p?.metadata?.is_default === "false")|| /regular/i.test(p?.nickname||'')  || p?.metadata?.type === 'regular';
    let discounted = active.find(isDisc);
    let regular    = active.find(isReg);
    if (!discounted || !regular) {
      const byAmt = [...active].sort((a,b)=>a.unit_amount-b.unit_amount);
      discounted = discounted || byAmt[0];
      regular    = regular    || byAmt[byAmt.length-1];
      if (regular && discounted && regular.id === discounted.id) regular = discounted;
    }
    if (regular && discounted && regular.unit_amount < discounted.unit_amount) {
      const t = regular; regular = discounted; discounted = t;
    }
    return { regular, discounted };
  }

  // Classify package tier by product name
  function classifyTier(name='') {
    if (/Six\s+Pouches/i.test(name))   return 'premium';  // Best Value
    if (/Three\s+Pouches/i.test(name)) return 'popular';  // Most Popular
    if (/Two\s+Pouches/i.test(name))   return 'medium';
    if (/One\s+Pouch/i.test(name))     return 'basic';
    return 'basic';
  }

  function badgeHTML(tier) {
    if (tier === 'popular') {
      return `<div class="package-badge">${starIcon} Most Popular</div>`;
    }
    if (tier === 'premium') {
      return `<div class="package-badge">${starIcon} Best Value</div>`;
    }
    return '';
  }

  function buildCard(product, regular, discounted, selected=false) {
    const tier = classifyTier(product.name || '');
    const card = document.createElement('div');
    card.className = 'package-card' + (selected ? ' selected' : '');
    card.id = product.id;
    card.dataset.productId = product.id;
    card.dataset.productName = product.name || '';
    card.dataset.package = tier; // override bad API
    if (regular)    { card.dataset.regularAmount  = String(regular.unit_amount);   card.dataset.regularPriceId  = regular.id; }
    if (discounted) { card.dataset.discountAmount = String(discounted.unit_amount); card.dataset.discountPriceId = discounted.id; }

    const reg = regular?.unit_amount ?? null;
    const dis = discounted?.unit_amount ?? null;
    const hasDiscount = reg && dis && reg > dis;
    const pct = hasDiscount ? Math.round(((reg - dis) / reg) * 100) : 0;

    const badge = badgeHTML(tier);
    const icon  = selected ? checkedIcon() : uncheckedIcon();

    card.innerHTML = `
      ${badge}
      <div class="left">
        <div class="icon-check">${icon}</div>
        <div>
          <h4>${product.name || 'Product'}</h4>
          <p class="text-xs muted txt-discount">${hasDiscount ? `${pct}% OFF` : ''}</p>
        </div>
      </div>
      <div class="right">
        <div>
          <span class="text-sm muted strike txt-reg">${reg ? fmt(reg) : 'â€”'}</span>
          <span class="text-2xl semi-bold text-blue txt-price">${dis ? fmt(dis) : (reg ? fmt(reg) : 'â€”')}</span>
          <p class="text-xs text-green txt-save">${hasDiscount ? `You save ${fmt(reg - dis)}` : ''}</p>
        </div>
      </div>
    `;
    return card;
  }

  function updateIcons(container) {
    $$('.package-card', container).forEach(card => {
      const icon = card.querySelector('.icon-check');
      if (!icon) return;
      icon.innerHTML = card.classList.contains('selected') ? checkedIcon() : uncheckedIcon();
    });
  }

  function setOrderSummaryFromCard(card) {
    const reg = Number(card.dataset.regularAmount || '0');
    const dis = Number(card.dataset.discountAmount || '0') || reg;
    const discount = (reg && dis && reg > dis) ? (reg - dis) : 0;
    const osRegular = document.getElementById('os-regular');
    const osDiscount = document.getElementById('os-discount');
    const osFinal = document.getElementById('os-final');
    if (osRegular)  osRegular.textContent  = reg ? fmt(reg) : 'â€”';
    if (osDiscount) osDiscount.textContent = discount ? `- ${fmt(discount)}` : 'â€”';
    if (osFinal)    osFinal.textContent    = fmt(dis);
  }

  function chosenPriceForCard(card) {
    const timeLeft = (typeof window.timeLeft === 'number') ? window.timeLeft : 0;
    const reg = card.dataset.regularPriceId;
    const dis = card.dataset.discountPriceId;
    if (timeLeft > 0 && dis) return dis;
    return reg || dis || null;
  }

  function ensureCheckoutStateFromSelected() {
    const selected = document.querySelector('.package-card.selected') || document.querySelector('.package-card');
    if (!selected) return false;
    const priceId = chosenPriceForCard(selected);
    if (!priceId) return false;

    const unit_amount = (priceId === selected.dataset.discountPriceId)
      ? Number(selected.dataset.discountAmount || '0')
      : Number(selected.dataset.regularAmount || selected.dataset.discountAmount || '0');

    window.productData = {
      product_id: selected.dataset.productId,
      product: { id: selected.dataset.productId, name: selected.dataset.productName },
      price: { id: priceId, unit_amount },
      tax_amount: 0,
      shipping_cost: 0,
      total_amount: unit_amount
    };
    window.activePriceId = priceId;

    const osFinal = document.getElementById('os-final');
    if (osFinal) osFinal.textContent = fmt(unit_amount);
    return true;
  }

  async function buildCardsFromAPI() {
    const box = document.getElementById('box');
    if (!box) return;
    box.innerHTML = '';

    const raw = await fetchPrices();
    const nad = filterNAD(raw);
    const map = byProduct(nad);

    const groups = [];
    for (const [pid, prices] of map.entries()) {
      const { regular, discounted } = resolveRegularDiscount(prices);
      const product = prices[0]?.product || { id: pid, name: 'Product' };
      groups.push({ product, regular, discounted });
    }

    // Optional sort: cheapest first
    groups.sort((a,b) => {
      const aa = a.discounted?.unit_amount ?? a.regular?.unit_amount ?? 999999;
      const bb = b.discounted?.unit_amount ?? b.regular?.unit_amount ?? 999999;
      return aa - bb;
    });

    groups.forEach((g, idx) => {
      const el = buildCard(g.product, g.regular, g.discounted, idx === 0);
      box.appendChild(el);
    });

    // Selection behavior + icon toggle
    box.addEventListener('click', (e) => {
      const card = e.target.closest('.package-card');
      if (!card) return;
      $$('.package-card', box).forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
      setOrderSummaryFromCard(card);
      updateIcons(box);
    }, { passive: true });

    // Initialize summary + icons
    const first = $('.package-card', box);
    if (first) setOrderSummaryFromCard(first);
    updateIcons(box);
  }

  // Guard the Order button so checkout always has priceId
  function installOrderGuard() {
    const btn = document.getElementById('purchase-btn') || document.getElementById('orderBtn');
    if (!btn || btn.__orderGuardInstalled) return;
    btn.__orderGuardInstalled = true;
    btn.addEventListener('click', async (evt) => {
      if (window.productData?.price?.id) return;
      evt.stopPropagation(); evt.preventDefault();
      if (!document.querySelector('.package-card')) {
        try { await buildCardsFromAPI(); } catch(e){ console.error(e); }
      }
      if (!ensureCheckoutStateFromSelected()) {
        alert('Price not loaded. Please select a package.');
        return;
      }
      setTimeout(() => btn.click(), 0);
    }, true);
  }

  // Keep earlier "regular price after expiry" & remove badges on expiry if you had that patch
  if (typeof window.applyRegularPricingOnce === 'function') {
    const __orig = window.applyRegularPricingOnce;
    window.applyRegularPricingOnce = function () {
      __orig();
      ensureCheckoutStateFromSelected();
      document.querySelectorAll('.package-badge').forEach(el => el.remove());
    };
  }

  window.buildCardsFromAPI = buildCardsFromAPI;
  window.addEventListener('DOMContentLoaded', async () => {
    try { await buildCardsFromAPI(); } catch (e) { console.error('Build cards failed:', e); }
    installOrderGuard();
  });
})();
</script>
<!-- /PATCH -->

</body>
</html>